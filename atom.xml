<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ¡¥å¤´æ‰“å­—å‘˜</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-07-17T09:29:48.922Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Henry</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>GStreamerå­¦ä¹ ç¬”è®°--GObjectç±»å¯¹è±¡</title>
    <link href="http://example.com/2021/07/17/gstreamer%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Gobject%E7%B1%BB%E5%AF%B9%E8%B1%A1/"/>
    <id>http://example.com/2021/07/17/gstreamer%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Gobject%E7%B1%BB%E5%AF%B9%E8%B1%A1/</id>
    <published>2021-07-17T08:48:47.000Z</published>
    <updated>2021-07-17T09:29:48.922Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GStreamerå­¦ä¹ ç¬”è®°â€“GObjectç±»å¯¹è±¡"><a href="#GStreamerå­¦ä¹ ç¬”è®°â€“GObjectç±»å¯¹è±¡" class="headerlink" title="GStreamerå­¦ä¹ ç¬”è®°â€“GObjectç±»å¯¹è±¡"></a>GStreamerå­¦ä¹ ç¬”è®°â€“GObjectç±»å¯¹è±¡</h1><h2 id="Gobjectç±»å®šä¹‰"><a href="#Gobjectç±»å®šä¹‰" class="headerlink" title="Gobjectç±»å®šä¹‰"></a>Gobjectç±»å®šä¹‰</h2><p>ç»´åŸºç™¾ç§‘ï¼š<strong>GObject</strong>ï¼Œæ˜¯ä¸€ä¸ªåœ¨<a href="https://zh.wikipedia.org/wiki/LGPL">LGPL</a>ä¸‹å‘å¸ƒçš„<a href="https://zh.wikipedia.org/wiki/%E8%87%AA%E7%94%B1%E8%BD%AF%E4%BB%B6">è‡ªç”±</a><a href="https://zh.wikipedia.org/wiki/%E8%BD%AF%E4%BB%B6%E5%BA%93">è½¯ä»¶åº“</a>ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªè½»ä¾¿çš„<a href="https://zh.wikipedia.org/w/index.php?title=%E5%AF%B9%E8%B1%A1%E7%B3%BB%E7%BB%9F&action=edit&redlink=1">å¯¹è±¡ç³»ç»Ÿ</a>å¹¶æ”¯æŒé€æ˜çš„å¤šè¯­è¨€äº’é€šã€‚GObjectè¢«è®¾è®¡ä¸ºå¯ä»¥ç›´æ¥ä½¿ç”¨åœ¨<a href="https://zh.wikipedia.org/wiki/C%E8%AF%AD%E8%A8%80">C</a>ç¨‹åºä¸­ï¼Œä¹Ÿå¯ä»¥è¢«å°è£…è‡³å…¶ä»–è¯­è¨€ï¼Œä¾‹å¦‚<a href="https://zh.wikipedia.org/wiki/C%2B%2B">C++</a>ï¼Œ<a href="https://zh.wikipedia.org/wiki/Java">Java</a>ï¼Œ<a href="https://zh.wikipedia.org/wiki/Python">Python</a>ï¼Œä»¥åŠå¯ä»¥ç”ŸæˆCä»£ç çš„<a href="https://zh.wikipedia.org/wiki/Vala">Vala</a>ï¼ˆç”±æ­¤å¤§å¤§ç®€åŒ–äº†<code>GObject</code>ä»£ç çš„ä¹¦å†™ï¼‰ç­‰ç­‰ã€‚</p><p><code>Gstreamer</code>æ¡†æ¶æ˜¯åŸºäºæ’ä»¶çš„ï¼ŒåŒæ—¶æ’ä»¶æ˜¯å¯ä»¥åŠ¨æ€çš„æ³¨å†Œã€åˆ›å»ºï¼Œ<code>gstreamer</code>åŸºäº<code>Gobject</code>å¼€å‘ï¼Œä¸‹é¢æ¥äº†è§£ä¸€ä¸‹<code>gstreamer</code>æ˜¯å¦‚ä½•é€šè¿‡<code>Gobject</code>å®Œæˆè‡ªå®šä¹‰ç±»çš„æ³¨å†Œã€‚</p><p>åœ¨æ¯ä¸ªç±»çš„<code>c</code>æ–‡ä»¶ä¸­ï¼Œéƒ½ä¼šæœ‰ä»¥ä¸‹è¿™æ ·çš„ä¸€ä¸ªå®å®šä¹‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G_DEFINE_TYPE (GstV4l2Allocator, gst_v4l2_allocator, GST_TYPE_ALLOCATOR);</span><br></pre></td></tr></table></figure><p><code>G_DEFINE_TYPE</code>æ˜¯ä¸€ä¸ªå®å®šä¹‰ï¼Œé‚£ä¹ˆè¿™ä¸ª<code>G_DEFINE_TYPE</code>å®æ˜¯å¦‚ä½•å®Œæˆå‘<code>Gobject</code>ç³»ç»Ÿå®Œæˆç±»çš„æ³¨å†Œå‘¢ï¼Ÿ</p><p>å°†<code>G_DEFINE_TYPE</code>å±•å¼€å¯ä»¥çœ‹åˆ°ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_DEFINE_TYPE(TN, t_n, T_P)</span></span><br><span class="line"><span class="comment">/******* </span></span><br><span class="line"><span class="comment"> *TN  ---&gt; TypeName</span></span><br><span class="line"><span class="comment"> *t_n ---&gt; type_name</span></span><br><span class="line"><span class="comment"> *T_P ---&gt; TYPE_PARENT</span></span><br><span class="line"><span class="comment"> *_f_ ---&gt; 0</span></span><br><span class="line"><span class="comment"> *_c_ ---&gt; &#123;&#125;</span></span><br><span class="line"><span class="comment">******/</span></span><br><span class="line"><span class="comment">/*****   ä»¥ä¸‹ä¸ºå®å±•å¼€   *****/</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span>     type_name##_init              (TypeName        *self); </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span>     type_name##_class_init        (TypeName##Class *klass); </span><br><span class="line"><span class="keyword">static</span> gpointer type_name##_parent_class = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">static</span> gint     TypeName##_private_offset;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span>     type_name##_class_intern_init (gpointer klass)</span><br><span class="line">&#123;</span><br><span class="line">  type_name##_parent_class = g_type_class_peek_parent (klass);</span><br><span class="line">  <span class="keyword">if</span> (TypeName##_private_offset != <span class="number">0</span>)</span><br><span class="line">    g_type_class_adjust_private_offset (klass, &amp;TypeName##_private_offset);</span><br><span class="line">  type_name##_class_init ((TypeName##Class*) klass);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">inline</span> gpointer</span><br><span class="line">type_name##_get_instance_private (TypeName *self)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> (G_STRUCT_MEMBER_P (self, TypeName##_private_offset));</span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line">GType </span><br><span class="line">type_name##_get_type (<span class="keyword">void</span>) </span><br><span class="line">&#123; </span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">volatile</span> gsize g_define_type_id__volatile = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">/* Prelude goes here */</span></span><br><span class="line">  <span class="keyword">if</span> (g_once_init_enter (&amp;g_define_type_id__volatile))</span><br><span class="line">    &#123;</span><br><span class="line">      GType g_define_type_id =</span><br><span class="line">        g_type_register_static_simple (TYPE_PARENT,</span><br><span class="line">                                       g_intern_static_string (#TypeName),</span><br><span class="line">                                       <span class="keyword">sizeof</span> (TypeName##Class),</span><br><span class="line">                                       (GClassInitFunc)(<span class="keyword">void</span> (*)(<span class="keyword">void</span>)) type_name##_class_intern_init,</span><br><span class="line">                                       <span class="keyword">sizeof</span> (TypeName),</span><br><span class="line">                                       (GInstanceInitFunc)(<span class="keyword">void</span> (*)(<span class="keyword">void</span>)) type_name##_init,</span><br><span class="line">                                       (GTypeFlags) flags);</span><br><span class="line">      &#123; <span class="comment">/* custom code follows */</span></span><br><span class="line">      &#123;_C_;&#125;</span><br><span class="line">        <span class="comment">/* following custom code */</span></span><br><span class="line">      &#125;</span><br><span class="line">      g_once_init_leave (&amp;g_define_type_id__volatile, g_define_type_id);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">return</span> g_define_type_id__volatile;</span><br><span class="line">&#125; <span class="comment">/* closes type_name##_get_type() */</span></span><br></pre></td></tr></table></figure><h2 id="å‘Gobjectç³»ç»Ÿæ³¨å†Œç±»"><a href="#å‘Gobjectç³»ç»Ÿæ³¨å†Œç±»" class="headerlink" title="å‘Gobjectç³»ç»Ÿæ³¨å†Œç±»"></a>å‘Gobjectç³»ç»Ÿæ³¨å†Œç±»</h2><p><code>G_DEFINE_TYPE</code>å®šä¹‰å¦‚ä¸Šï¼Œé‚£ä¹ˆï¼Œæœ€ç»ˆå®ƒæ˜¯å¦‚ä½•å‘<code>Gobject</code>ç³»ç»Ÿæ³¨å†Œè¯¥ç±»çš„å‘¢ï¼Ÿ<br><code>Gobject</code>ç³»ç»Ÿä¸ºä»€ä¹ˆçŸ¥é“ä½ æ–°æ·»åŠ äº†ä¸€ä¸ªåå«<code>TypeName</code>çš„ç±»ï¼Œæ˜¯å› ä¸ºä½ é€šè¿‡<code>g_type_register_static_simple()</code>å‡½æ•°å‘Šè¯‰å®ƒï¼Œæˆ‘è¿™é‡Œæœ‰ä¸€ä¸ªæ–°ç±»ï¼Œä½ ç™»è®°ä¸€ä¸‹<code>g_type_register_static_simple()</code>å‡½æ•°å£°æ˜å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">GLIB_AVAILABLE_IN_ALL</span></span><br><span class="line"><span class="function">GType <span class="title">g_type_register_static_simple</span>     <span class="params">(GType                       parent_type,</span></span></span><br><span class="line"><span class="params"><span class="function"> <span class="keyword">const</span> gchar                *type_name,</span></span></span><br><span class="line"><span class="params"><span class="function"> guint                       class_size,</span></span></span><br><span class="line"><span class="params"><span class="function"> GClassInitFunc              class_init,</span></span></span><br><span class="line"><span class="params"><span class="function"> guint                       instance_size,</span></span></span><br><span class="line"><span class="params"><span class="function"> GInstanceInitFunc           instance_init,</span></span></span><br><span class="line"><span class="params"><span class="function"> GTypeFlags             flags)</span></span>;</span><br></pre></td></tr></table></figure><p>å‡½æ•°å£°æ˜çš„å‰é¢<code>GLIB_AVAILABLE_IN_ALL</code>å°±æ˜¯ä¸€ä¸ª<code>extern</code>å…³é”®è¯ï¼Œä»å‡½æ•°å£°æ˜æˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼Œå‘<code>Gobject</code>ç³»ç»Ÿæ³¨å†Œä¸€ä¸ªç±»ï¼Œéœ€è¦å‘Šè¯‰<code>Gobject</code>ç³»ç»Ÿï¼Œæˆ‘ç°åœ¨éœ€è¦æ³¨å†Œä¸€ä¸ªæ–°ç±»ï¼Œå®ƒçˆ¶ç±»çš„ç±»å‹æ˜¯<code>parent_type</code>ï¼Œå¤§å°æ˜¯<code>class_size</code>ï¼Œç±»çš„åˆå§‹åŒ–å‡½æ•°æ˜¯<code>class_init</code>ï¼Œç±»çš„å®ä¾‹å¤§å°ä»¥åŠåˆå§‹åŒ–å‡½æ•°ï¼Œè¿˜æœ‰è¿™ä¸ªç±»æœ‰ä»€ä¹ˆ<code>flags</code>ï¼Œé€šè¿‡å‘Šè¯‰<code>Gobject</code>ï¼Œå®ƒå°±ä¼šå°†æ–°ç±»ç™»è®°åœ¨çº¿ã€‚</p><p>é€šè¿‡<code>G_DEFINE_TYPE</code>å®çš„å±•å¼€å¯ä»¥çŸ¥é“ï¼Œåœ¨<code>type_name##_get_type()</code>å‡½æ•°ä¸­è°ƒç”¨åˆ°<code>g_type_register_static_simple()</code>å‡½æ•°ï¼Œé‚£ä¹ˆï¼Œç©¶ç«Ÿæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Œç¨‹åºä¼šå‘<code>Gobject</code>ç³»ç»Ÿæ³¨å†Œè¯¥æ–°ç±»å‘¢ï¼Ÿ<br>æ¯”å¦‚æˆ‘ä»¬æ˜¯è¦æ³¨å†Œä¸€ä¸ªåå«<code>TestObject</code>çš„ç±»ï¼Œé‚£ä¹ˆå°±æ˜¯é€šè¿‡<code>TestObject_get_type()</code>å‡½æ•°å®Œæˆ<code>estObject</code>çš„æ³¨å†Œç™»è®°ã€‚<br>åœ¨æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª<code>TestObject</code>çš„å®ä¾‹æ—¶ï¼Œä¼šé€šè¿‡è°ƒç”¨<code>g_object_new()</code>å‡½æ•°å®Œæˆï¼Œåœ¨è°ƒç”¨<code>g_object_new</code>å‡½æ•°ï¼Œéœ€è¦ä¼ è¿›ç›¸åº”çš„å‚æ•°ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å°†<code>TestObject_get_type()</code>å‡½æ•°çš„è¿”å›å€¼ä¼ é€’ç»™å®ƒï¼Œå³æ¼”å˜æˆä»¥ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TestObject *testObject = ï¼ˆTestObject *ï¼‰g_object_new (TestObject_get_type(), <span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure><p>åœ¨åˆ›å»º<code>TestObject</code>å®ä¾‹å¯¹è±¡çš„æ—¶å€™ï¼Œå°†ä¼šè°ƒç”¨<code>TestObject_get_type()</code>å‡½æ•°å¾—åˆ°ç›¸åº”çš„ç±»å‹ï¼Œè€Œåœ¨<code>TestObject_get_type()</code>å‡½æ•°ä¸­ï¼Œå°†ä¼šå…ˆé€šè¿‡<code>g_once_init_enter()</code>å‡½æ•°æ£€æŸ¥<code>TestObject_get_type()</code>ä¸­çš„é™æ€å˜é‡<code>g_define_type_id_volatile</code>æ˜¯å¦ä¸º0ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™é€šè¿‡<code>g_type_register_static_simple()</code>å‡½æ•°å‘<code>Gobject</code>ç³»ç»Ÿç™»è®°<code>TestObject</code>ç±»ï¼ŒåŒæ—¶è¿”å›<code>object ID</code>ï¼Œå¦‚æœ<code>g_define_type_id_volatile</code>ä¸ä¸º0ï¼Œåˆ™è¯´æ˜å·²ç»å‘<code>Gobject</code>ç³»ç»Ÿæ³¨å†Œ<code>TestObjec</code>tç±»ï¼Œç›´æ¥è¿”å›<code>object ID</code>ï¼Œè¿™æ ·ï¼Œå³å®Œæˆäº†<code>TestObject</code>çš„æ³¨å†Œç™»è®°ã€‚</p><h2 id="ç±»çš„æ„é€ å‡½æ•°"><a href="#ç±»çš„æ„é€ å‡½æ•°" class="headerlink" title="ç±»çš„æ„é€ å‡½æ•°"></a>ç±»çš„æ„é€ å‡½æ•°</h2><p>å­¦ä¹ <code>C++</code>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œç±»æ˜¯æœ‰æ„é€ å‡½æ•°çš„ï¼Œåœ¨åˆ›å»ºç±»å®ä¾‹çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥ç±»çš„æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆï¼Œåœ¨<code>Gobject</code>ä¸­ï¼Œåˆæ˜¯æ€ä¹ˆè°ƒç”¨ç±»çš„æ„é€ å‡½æ•°å‘¢ï¼Ÿ</p><p>ä»¥<code>TestObject</code>ä¸ºä¾‹ï¼Œåœ¨ä¸Šé¢è¯´åˆ°é€šè¿‡<code>g_type_register_static_simple()</code>å‡½æ•°å‘<code>Gobject</code>ç³»ç»Ÿæ³¨å†Œè‡ªå®šä¹‰ç±»çš„æ—¶å€™ï¼Œå°±ä¼ è¿›äº†ç›¸åº”çš„å‚æ•°ï¼ŒåŒ…æ‹¬ç±»çš„åˆå§‹åŒ–å‡½æ•°<code>test_object_class_intern_init()</code>ä»¥åŠç±»å®ä¾‹çš„åˆå§‹åŒ–å‡½æ•°<code>test_object_init()</code>ï¼Œå®ƒä»¬ä¸¤ä¸ªå…±åŒçš„ç›¸å½“äº<code>TestObject</code>ç±»çš„æ„é€ å‡½æ•°ã€‚ä»å®å®šä¹‰<code>G_DEFINE_TYPE</code>çš„å±•å¼€ä»£ç ä¸­å‘ç°ä»¥ä¸‹å‡½æ•°å£°æ˜ä»¥åŠ<code>test_object_class_intern_init()</code>å‡½æ•°çš„å®šä¹‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span>     <span class="title">test_object_init</span>              <span class="params">(TestObject      *self)</span></span>; </span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span>     <span class="title">test_object_class_init</span>        <span class="params">(TestObjectClass *klass)</span></span>; </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span>     <span class="title">test_object_class_intern_init</span> <span class="params">(gpointer klass)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  test_object_parent_class = g_type_class_peek_parent (klass);</span><br><span class="line">  <span class="keyword">if</span> (test_object_private_offset != <span class="number">0</span>)</span><br><span class="line">    g_type_class_adjust_private_offset (klass, &amp;TestObject_private_offset);</span><br><span class="line">  test_object_class_init ((TestObjectClass*) klass);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šè¿°ä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåœ¨é€šè¿‡<code>G_DEFINE_TYPE</code>å‘<code>Gobject</code>ç³»ç»Ÿæ³¨å†Œç±»ï¼Œè¿˜éœ€è¦æˆ‘ä»¬å®ç°<code>test_object_class_init()</code>å’Œ<code>test_object_init()</code>å‡½æ•°çš„å®šä¹‰ã€‚<code>test_object_class_init()</code>å‡½æ•°æ˜¯åœ¨ç¬¬ä¸€æ¬¡åˆ›å»º<code>TestObject</code>ç±»å®ä¾‹å¯¹è±¡çš„æ—¶å€™è°ƒç”¨çš„ï¼Œè¯¥å‡½æ•°åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œè€Œ<code>test_object_init()</code>å‡½æ•°åˆ™æ˜¯æ¯æ¬¡åˆ›å»º<code>TestObject</code>ç±»å®ä¾‹å¯¹è±¡éƒ½ä¼šè°ƒç”¨ã€‚</p><h2 id="ç±»çš„ç»§æ‰¿å…³ç³»"><a href="#ç±»çš„ç»§æ‰¿å…³ç³»" class="headerlink" title="ç±»çš„ç»§æ‰¿å…³ç³»"></a>ç±»çš„ç»§æ‰¿å…³ç³»</h2><p>åœ¨<code>G_DEFINE_TYPE</code>çš„å±•å¼€ä»£ç ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ä»¥ä¸‹ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> gpointer type_name##_parent_class = <span class="literal">NULL</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span>     type_name##_class_intern_init (gpointer klass)</span><br><span class="line">&#123;</span><br><span class="line">  type_name##_parent_class = g_type_class_peek_parent (klass);</span><br><span class="line">  <span class="keyword">if</span> (TypeName##_private_offset != <span class="number">0</span>)</span><br><span class="line">    g_type_class_adjust_private_offset (klass, &amp;TypeName##_private_offset);</span><br><span class="line">  type_name##_class_init ((TypeName##Class*) klass);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªå®ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å®šä¹‰äº†ä¸€ä¸ªé™æ€çš„å…¨å±€æŒ‡é’ˆå˜é‡<code>type_name_parent_class</code>ï¼Œè€Œ<code>type_name_parent_class</code>å˜é‡æ˜¯é€šè¿‡<code>g_type_class_peek_parent()</code>å‡½æ•°èµ‹å€¼çš„ï¼Œ<code>type_name_parent_class</code>å˜é‡ä»£è¡¨ç€ä»€ä¹ˆå‘¢ï¼Œå®ƒå°±æ˜¯çˆ¶ç±»ã€‚ä¸€èˆ¬çš„ï¼Œä¼šåœ¨è¯¥æºæ–‡ä»¶æ–°å¢ä¸€ä¸ªå®ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> type_name##_parent_class parent_class</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥é€šè¿‡å®å®šä¹‰<code>parent_class</code>ç›´æ¥è°ƒç”¨çˆ¶ç±»å‡½æ•°ï¼Œè€Œè¯¥çˆ¶ç±»ï¼Œå°±æ˜¯åœ¨é€šè¿‡å®å®šä¹‰<code>G_DEFINE_TYPE</code>å‘<code>Gobject</code>ç³»ç»Ÿæ³¨å†Œç±»æ—¶ä¼ è¿›çš„ç¬¬ä¸‰ä¸ªå‚æ•°<code>T_P</code>ã€‚<code>g_type_class_peek_parent()</code>å‡½æ•°é€šè¿‡ä¼ è¿›çš„å­ç±»æŒ‡é’ˆï¼ŒæŸ¥æ‰¾åˆ°æ³¨å†Œæ—¶å€™çš„ç›¸åº”ä¿¡æ¯ï¼Œå¾—åˆ°çˆ¶ç±»çš„ç±»å‹ï¼Œè€Œåé€šè¿‡çˆ¶ç±»ç±»å‹å¾—åˆ°çˆ¶ç±»ä¿¡æ¯å¹¶è¿”å›ã€‚</p><h2 id="ç±»çš„ææ„å‡½æ•°"><a href="#ç±»çš„ææ„å‡½æ•°" class="headerlink" title="ç±»çš„ææ„å‡½æ•°"></a>ç±»çš„ææ„å‡½æ•°</h2><p>æœ‰äº†ç›¸åº”çš„æ„é€ å‡½æ•°ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­ç”³è¯·äº†å†…å­˜ã€ç¡¬ä»¶ç­‰èµ„æºï¼Œè‡ªç„¶çš„ï¼Œä¹Ÿä¼šç±»ä¼¼<code>C++</code>çš„ï¼Œæœ‰ç›¸åº”çš„ææ„å‡½æ•°è´Ÿè´£èµ„æºçš„é‡Šæ”¾æ“ä½œã€‚é‚£ä¹ˆï¼Œåœ¨<code>Gobject</code>ç³»ç»Ÿä¸­ï¼Œææ„å‡½æ•°åˆæ˜¯ä»€ä¹ˆå›äº‹å‘¢ï¼Ÿæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæ„é€ å‡½æ•°æ˜¯ä»çˆ¶ç±»åˆ°å­ç±»ï¼Œè€Œææ„å‡½æ•°æ˜¯ä»å­ç±»åˆ°çˆ¶ç±»ã€‚åœ¨<code>Gobject</code>ç³»ç»Ÿä¸­çš„ææ„å‡½æ•°åˆæ˜¯å¦‚ä½•çš„å‘¢ï¼Ÿ</p><p>ä¹‹å‰è¯´åˆ°ï¼Œåœ¨é€šè¿‡<code>G_DEFINE_TYPE</code>å‘<code>Gobject</code>ç³»ç»Ÿï¼Œæ³¨å†Œ<code>TestObject</code>ç±»çš„æ—¶å€™ï¼Œéœ€è¦å®šä¹‰<code>test_object_class_init()</code>å’Œ<code>test_object_init()</code>å‡½æ•°ï¼Œè€Œåœ¨ç±»å®ä¾‹çš„åˆå§‹åŒ–å‡½æ•°<code>test_object_init()</code>ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ç”³è¯·äº†ä¸€äº›å†…å­˜ç­‰èµ„æºï¼Œæˆ‘ä»¬éœ€è¦åœ¨ææ„å‡½æ•°ä¸­é‡Šæ”¾è¿™äº›èµ„æºï¼Œè¿™ä¸ªæ—¶å€™ï¼Œéœ€è¦æˆ‘ä»¬åœ¨<code>TestObject</code>ç±»åˆå§‹åŒ–å‡½æ•°<code>test_object_class_init()</code>è¦†ç›–ä»çˆ¶ç±»ç»§æ‰¿çš„ææ„å‡½æ•°ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">static void</span><br><span class="line">test_object_dispose (GObject * object)</span><br><span class="line">&#123;</span><br><span class="line">TestObject *testobject = TEST_OBJECT (object);</span><br><span class="line"> </span><br><span class="line">/*  èµ„æºé‡Šæ”¾*/</span><br><span class="line"> </span><br><span class="line">/*  è°ƒç”¨çˆ¶ç±»çš„dispose å‡½æ•° */</span><br><span class="line">G_OBJECT_CLASS (parent_class)-&gt;dispose (object);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">static void</span><br><span class="line">test_object_finalize (TestObject * testobject)</span><br><span class="line">&#123;</span><br><span class="line">g_free(testobject-&gt;mem);</span><br><span class="line"></span><br><span class="line">    /*  è°ƒç”¨çˆ¶ç±»çš„finalize å‡½æ•° */</span><br><span class="line">G_OBJECT_CLASS (parent_class)-&gt;finalize (object);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">static void test_object_init(TestObject * self)</span><br><span class="line">&#123;</span><br><span class="line">self-&gt;mem = g_malloc (1);</span><br><span class="line">&#125;</span><br><span class="line">static void test_object_class_init(TestObjectClass *klass)</span><br><span class="line">&#123;</span><br><span class="line">GObjectClass *object_class = G_OBJECT_CLASS (klass);</span><br><span class="line"> </span><br><span class="line">object_class-&gt;dispose = test_object_dispose;</span><br><span class="line">object_class-&gt;finalize = test_object_finalize;</span><br><span class="line"> </span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±ä¸Šè¿°ä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåœ¨<code>TestObject</code>çš„åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå°†ä¼šè¦†ç›–ä»çˆ¶ç±»ç»§æ‰¿è€Œæ¥çš„ææ„å‡½æ•°ï¼ŒåŒæ—¶åœ¨ææ„å‡½æ•°ä¸­é‡Šæ”¾ç±»å®ä¾‹åˆå§‹åŒ–æ—¶å ç”¨çš„èµ„æºï¼ŒåŒæ—¶è¿˜æœ‰é€’å½’è°ƒç”¨çˆ¶ç±»çš„ææ„å‡½æ•°ã€‚<code>dispose</code>å‡½æ•°ä¸»è¦æ˜¯å°†åœ¨ç±»ä¸­å ç”¨çš„èµ„æºé‡Šæ”¾ï¼Œè€Œ<code>finalize</code>å‡½æ•°åˆ™æ˜¯æœ‰ç‚¹ç±»ä¼¼çœŸæ­£çš„ææ„å‡½æ•°ï¼Œå°†æ„é€ å‡½æ•°ç”³è¯·çš„èµ„æºè¿›è¡Œé‡Šæ”¾å›æ”¶ã€‚</p><p>æ—¢ç„¶ææ„å‡½æ•°ä¹Ÿå·²ç»æœ‰äº†ï¼Œææ„å‡½æ•°åˆä¼šæ˜¯ä»€ä¹ˆæ—¶å€™è°ƒç”¨å‘¢ï¼Ÿ</p><p><code> JAVA</code>ä½¿ç”¨çš„æ˜¯åƒåœ¾å›æ”¶çš„æœºåˆ¶ï¼Œè€Œ<code>Gobjec</code>tåˆ™æ˜¯ä½¿ç”¨å¼•ç”¨è®¡æ•°çš„æ–¹å¼ã€‚å½“æ¯ä¸ªå¯¹è±¡åˆ›å»ºçš„æ—¶å€™ï¼Œå°†ä¼šå¯¹å…¶å¼•ç”¨è®¡æ•°åŠ ä¸€ï¼Œå¦‚æœæœŸé—´è¢«å…¶ä»–å¯¹è±¡è¿›è¡Œå¼•ç”¨ï¼Œä¹Ÿéƒ½ä¼šå°†å®ƒçš„å¼•ç”¨è®¡æ•°å¢åŠ ï¼›è€Œå½“å¯¹è±¡è¢«è§£é™¤å¼•ç”¨çš„æ—¶å€™ï¼Œå¼•ç”¨è®¡æ•°å°†ä¼šå‡ä¸€ï¼Œå½“å¼•ç”¨è®¡æ•°å‡ä¸º0çš„æ—¶å€™ï¼Œå°†ä¼šè°ƒç”¨å¯¹è±¡çš„ææ„å‡½æ•°ï¼Œè¿›è¡Œèµ„æºçš„å›æ”¶ã€‚</p><p><code>Gobject</code>çš„å¼•ç”¨è®¡æ•°æ–¹å¼å¤§è‡´å¦‚ä¸‹ï¼š</p><ul><li>ä½¿ç”¨<code>g_object_new()</code>å‡½æ•°è¿›è¡Œå®ä¾‹åŒ–çš„æ—¶å€™ï¼Œå¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¸º1ï¼›</li><li>ä½¿ç”¨<code>g_object_ref()</code>å‡½æ•°è¿›è¡Œå¼•ç”¨å¯¹è±¡çš„æ—¶å€™ï¼Œå¯¹è±¡çš„å¼•ç”¨è®¡æ•°åŠ 1ï¼›</li><li>ä½¿ç”¨<code>g_object_unref()</code>å‡½æ•°è§£é™¤å¼•ç”¨çš„æ—¶å€™ï¼Œå¯¹è±¡çš„å¼•ç”¨è®¡æ•°å‡1ï¼›</li><li>è°ƒç”¨<code>g_object_unref()</code>å‡½æ•°è¿›è¡Œè§£å¼•ç”¨çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¸º0ï¼Œå°†ä¼šå…ˆåè°ƒç”¨è¯¥å¯¹è±¡çš„<code>dispose()</code>å‡½æ•°å’Œ<code>finalize()</code>å‡½æ•°ã€‚</li></ul><p>è€Œä¸ºä»€ä¹ˆåœ¨<code>test_object_class_init()</code>å‡½æ•°ä¸­è¦†ç›–ä»çˆ¶ç±»ç»§æ‰¿è¿‡æ¥çš„ææ„å‡½æ•°å‘¢ï¼Ÿ<br>å› ä¸ºåœ¨<code>g_object_unref()</code>å‡½æ•°ä¸­è°ƒç”¨<code>dispose()</code>å‡½æ•°å’Œ<code>finalize()</code>å‡½æ•°æ˜¯é€šè¿‡å®å®šä¹‰<code>G_OBJECT_GET_CLASSå–å¾—OBJECT_CLASS</code>ç±»ä¹‹åï¼Œå†è°ƒç”¨å®ƒçš„<code>dispose()</code>å‡½æ•°å’Œ<code>finalize()</code>å‡½æ•°ï¼Œæ‰€ä»¥éœ€è¦åœ¨<code>TestObject</code>çš„ç±»åˆå§‹åŒ–å‡½æ•°å¯¹è¿™ä¸¤ä¸ªå‡½æ•°æŒ‡é’ˆè¿›è¡Œè¦†ç›–ï¼Œè€Œåœ¨<code>TestObject</code>ç±»çš„<code>dispose()</code>å‡½æ•°å’Œ<code>finalize()</code>å‡½æ•°å†é€šè¿‡<code>G_OBJECT_CLASS (parent_class)</code>å–å¾—çˆ¶ç±»æŒ‡é’ˆï¼Œè°ƒç”¨çˆ¶ç±»çš„ææ„å‡½æ•°ã€‚</p><h2 id="ç±»çš„å…¶ä»–è®¾ç½®"><a href="#ç±»çš„å…¶ä»–è®¾ç½®" class="headerlink" title="ç±»çš„å…¶ä»–è®¾ç½®"></a>ç±»çš„å…¶ä»–è®¾ç½®</h2><p>åœ¨<code>Gobject</code>ç³»ç»Ÿä¸­ï¼Œè®¾ç½®äº†å¾ˆå¤šæ–¹ä¾¿çš„å®ï¼Œä½¿åœ¨ä½¿ç”¨å¯¹è±¡çš„æ—¶å€™å¯ä»¥æ›´åŠ çš„æ–¹ä¾¿ï¼Œåœ¨ç›¸åº”çš„å¤´æ–‡ä»¶ï¼Œä¸€èˆ¬ä¼šæœ‰å¦‚ä¸‹å®å®šä¹‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">GstTestObject</span> <span class="title">TestObject</span>;</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">GstTestObjectClass</span> <span class="title">GstTestObjectClass</span>;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* è·å–ç±»å‹ */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GST_TYPE_TEST_OBJECT      (test_object_get_type())</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* ç±»å®ä¾‹ç±»å‹åˆ¤æ–­ */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GST_IS_TEST_OBJECT(obj)   (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GST_TYPE_TEST_OBJECT))</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* ç±»ç»“æ„åˆ¤å®š */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GST_IS_TEST_OBJECT_CLASS(klass)      (G_TYPE_CHECK_CLASS_TYPE ((klass), GST_TYPE_TEST_OBJECT))</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* è·å–objçš„ç±»å‹ï¼ŒåŒæ—¶å°†å…¶è½¬æ¢ä¸ºGST_TYPE_TEST_OBJECTï¼Œå¹¶è¿”å›æŒ‡å‘GstTestObjectClassçš„æŒ‡é’ˆ */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GST_TEST_OBJECT_GET_CLASS(obj)       (G_TYPE_INSTANCE_GET_CLASS ((obj), GST_TYPE_TEST_OBJECT, GstTestObjectClass))</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* æ£€æŸ¥objæ˜¯å¦æ˜¯GST_TYPE_TEST_OBJECTç±»å‹ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å°†è¿”å›æŒ‡å‘objæˆå‘˜å˜é‡TestObjectçš„æŒ‡é’ˆ */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GST_TEST_OBJECT(obj)      (G_TYPE_CHECK_INSTANCE_CAST ((obj), GST_TYPE_TEST_OBJECT, TestObject))</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* æ£€æŸ¥klassæ˜¯ä¸æ˜¯GST_TYPE_TEST_OBJECTç±»å‹ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å°†è¿”å›æŒ‡å‘klassæˆå‘˜å˜é‡GstTestObjectClassçš„æŒ‡é’ˆ */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GST_TEST_OBJECT_CLASS(klass)         (G_TYPE_CHECK_CLASS_CAST ((klass), GST_TYPE_TEST_OBJECT, GstTestObjectClass))</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* å®ä¾‹ç»“æ„è½¬æ¢ */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GST_TEST_OBJECT_CAST(obj) ((TestObject*)(obj))</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">GstTestObject</span> &#123;</span></span><br><span class="line">  GstObject            object;</span><br><span class="line">  gchar *mem;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* ç±»å®šä¹‰ */</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">GstTestObjectClass</span> &#123;</span></span><br><span class="line">  GstObjectClass    object_class;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°±æ˜¯é€šè¿‡ä¸Šè¿°çš„å®å®šä¹‰ï¼Œå¯ä»¥æ–¹ä¾¿çš„å°†å„ç§ç±»ä»¥åŠå¯¹è±¡è¿›è¡Œè½¬æ¢ï¼Œåœ¨å­ç±»ä¸­å¯ä»¥è°ƒç”¨çˆ¶ç±»çš„å‡½æ•°ç­‰æ“ä½œï¼ŒåŒæ—¶ï¼Œåœ¨<code>gstreamer</code>ä¸­ï¼Œè¿˜æœ‰ä¸€äº›å±æ€§è®¾ç½®å‡½æ•°ç­‰ï¼Œè¿›è¡Œå¤šæ ·åŒ–çš„ç±»ç®¡ç†ã€‚</p><p>å¦å¤–çš„ï¼Œå®å®šä¹‰<code>G_DEFINE_TYPE_WITH_CODE</code>ä¹Ÿæ˜¯å®ç°ä¸<code>G_DEFINE_TYP</code>ç±»ä¼¼çš„åŠŸèƒ½ï¼Œåªä¸è¿‡æ˜¯å¯ä»¥å°†ä¸€äº›å‡½æ•°å†…ç½®åœ¨<code>type_name##_get_type()</code>å‡½æ•°ä¸­ã€‚</p>]]></content>
    
    
    <summary type="html">GObject è®¾è®¡ç”¨äºç›´æ¥åœ¨Cç¨‹åºä¸­ä½¿ç”¨ä»¥æä¾›é¢å‘å¯¹è±¡çš„åŸºäºCçš„APIï¼Œå¹¶é€šè¿‡ä¸å…¶ä»–è¯­è¨€çš„ç»‘å®šæ¥æä¾›é€æ˜çš„è·¨è¯­è¨€äº’æ“ä½œæ€§ï¼Œä¾‹å¦‚PyGObjectã€‚</summary>
    
    
    
    <category term="Internship" scheme="http://example.com/categories/Internship/"/>
    
    
    <category term="GStreamer" scheme="http://example.com/tags/GStreamer/"/>
    
    <category term="GObject" scheme="http://example.com/tags/GObject/"/>
    
  </entry>
  
  <entry>
    <title>Deepstream æ£€æµ‹å®‰å…¨å¸½ğŸ‘·</title>
    <link href="http://example.com/2021/07/10/week-2-2/"/>
    <id>http://example.com/2021/07/10/week-2-2/</id>
    <published>2021-07-10T05:32:29.000Z</published>
    <updated>2021-07-14T11:57:38.559Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Yolov3-æ£€æµ‹å®‰å…¨å¸½"><a href="#Yolov3-æ£€æµ‹å®‰å…¨å¸½" class="headerlink" title="Yolov3 æ£€æµ‹å®‰å…¨å¸½"></a>Yolov3 æ£€æµ‹å®‰å…¨å¸½</h1><h2 id="è¿è¡Œè‡ªå¸¦yolov3ç¤ºä¾‹"><a href="#è¿è¡Œè‡ªå¸¦yolov3ç¤ºä¾‹" class="headerlink" title="è¿è¡Œè‡ªå¸¦yolov3ç¤ºä¾‹"></a>è¿è¡Œè‡ªå¸¦yolov3ç¤ºä¾‹</h2><h3 id="ç¯å¢ƒå’Œç¤ºä¾‹è¯´æ˜"><a href="#ç¯å¢ƒå’Œç¤ºä¾‹è¯´æ˜" class="headerlink" title="ç¯å¢ƒå’Œç¤ºä¾‹è¯´æ˜"></a>ç¯å¢ƒå’Œç¤ºä¾‹è¯´æ˜</h3><p><strong>è¯¥ç¤ºä¾‹æ˜¯Deepstream-5.0åœ¨Jetson Xavier NXä¸Šè¿è¡Œï¼Œå…·ä½“ç¯å¢ƒéƒ¨ç½²å¯ä»¥å‚è§<a href="https://xuhuigeren.github.io/2021/07/02/week-1/">è¿™é‡Œ</a>.</strong></p><p>ç¤ºä¾‹æ–‡ä»¶åœ¨<code>deepstram-5.0\sources\objectDetector_Yolo</code>ç›®å½•ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">|-- objectDetector_Yolo</span><br><span class="line">|   |-- config_infer_primary_yoloV2.txt</span><br><span class="line">|   |-- config_infer_primary_yoloV2_tiny.txt</span><br><span class="line">|   |-- config_infer_primary_yoloV3.txt</span><br><span class="line">|   |-- config_infer_primary_yoloV3_tiny.txt</span><br><span class="line">|   |-- deepstream_app_config_yoloV2.txt</span><br><span class="line">|   |-- deepstream_app_config_yoloV2_tiny.txt</span><br><span class="line">|   |-- deepstream_app_config_yoloV3.txt</span><br><span class="line">|   |-- deepstream_app_config_yoloV3_tiny.txt</span><br><span class="line">|   |-- labels.txt</span><br><span class="line">|   |-- prebuild.sh</span><br><span class="line">|   |-- README</span><br><span class="line">|   |-- yolov3-calibration.table.trt7.0</span><br><span class="line">|   |-- nvdsinfer_custom_impl_Yolo             </span><br><span class="line">|       |-- Makefile</span><br><span class="line">|       |-- kernels.cu</span><br><span class="line">|       |-- nvdsinfer_yolo_engine.cpp</span><br><span class="line">|       |-- nvdsparsebbox_Yolo.cpp</span><br><span class="line">|       |-- trt_utils.cpp</span><br><span class="line">|       |-- trt_utils.h</span><br><span class="line">|       |-- yolo.cpp</span><br><span class="line">|       |-- yolo.h</span><br><span class="line">|       |-- yoloPlugins.cpp</span><br><span class="line">|       |-- yoloPlugins.h</span><br></pre></td></tr></table></figure><p><strong>å½“ç„¶æ˜¯å…ˆåº·åº·<code>README</code>ï¼Œæœç„¶å†™çš„éå¸¸ç»†è‡´è¯¦å°½ï¼Œä»‹ç»äº†æ–‡ä»¶ç›®å½•ä¸­æ¯ä¸ªæ–‡ä»¶çš„å«ä¹‰</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Sample contents:</span><br><span class="line">- deepstream_app_config_yolo[V3,V3_tiny,V2,V2_tiny,tlt].txt - DeepStream reference</span><br><span class="line">  app configuration file for using YoloV2/yoloV2-tiny/yolo/yolo-tiny/tlt model</span><br><span class="line">  as the primary detector.</span><br><span class="line">- config_infer_primary_yolo[V3,V3_tiny,V2,V2_tiny,tlt].txt - Configuration file for the GStreamer</span><br><span class="line">  nvinfer plugin for the Yolo detector model.</span><br><span class="line">- yolov3-calibration.table.trt7.0 - yoloV3 INT8 calibration binary on TensorRT 7.0+</span><br><span class="line">- nvdsinfer_custom_impl_Yolo/nvdsinfer_yolo_engine.cpp -</span><br><span class="line">  Implementation of &#x27;NvDsInferCreateModelParser&#x27;/IModelParser for nvdsinfer to</span><br><span class="line">  parse custom models. Alternatively, also contains implementation of</span><br><span class="line">  &#x27;NvDsInferYoloCudaEngineGet&#x27; for nvdsinfer to directly create cuda engine.</span><br><span class="line">  To use the &#x27;NvDsInferYoloCudaEngineGet&#x27; interface, enable the macro</span><br><span class="line">  USE_CUDA_ENGINE_GET_API in nvdsinfer_yolo_engine.cpp</span><br><span class="line">- nvdsinfer_custom_impl_Yolo/nvdsparsebbox_Yolo.cpp - Output layer</span><br><span class="line">  parsing function for detected objects for the Yolo model.</span><br><span class="line">- nvdsinfer_custom_impl_Yolo/yoloPlugins.h -</span><br><span class="line">  Declaration of YoloLayerV3 and YoloLayerV3PluginCreator.</span><br><span class="line">- nvdsinfer_custom_impl_Yolo/yoloPlugins.cpp -</span><br><span class="line">  Implementation of YoloLayerV3 and YoloLayerV3PluginCreator.</span><br><span class="line">- nvdsinfer_custom_impl_Yolo/kernels.cu - Implementation of cuda kernels for</span><br><span class="line">- nvdsinfer_custom_impl_Yolo/trt_utils.h - Utilities to setup tensorRT networks</span><br><span class="line">- nvdsinfer_custom_impl_Yolo/trt_utils.cpp - Implementation of Utilities to setup</span><br><span class="line">   tensorRT networks</span><br><span class="line">- nvdsinfer_custom_impl_Yolo/yolo.h - Interface to create Yolo Cuda-Engine</span><br><span class="line">- nvdsinfer_custom_impl_Yolo/yolo.cpp - Implementation to create Yolo Cuda-Engine</span><br></pre></td></tr></table></figure><p><strong>ä¸‹è½½æƒé‡å’Œé…ç½®æ–‡ä»¶</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Pre-requisites:</span><br><span class="line">- Download yolo config and weights files</span><br><span class="line">  $ ./prebuild.sh         # å¯ä»¥æŠŠè„šæœ¬é‡Œçš„ä¸éœ€è¦çš„éƒ¨åˆ†æ³¨é‡Šæ‰ï¼Œæé«˜ä¸‹è½½é€Ÿåº¦ã€‚</span><br><span class="line">- Set correct yolo config/weights file in config_infer_primary_yolo[...].txt.</span><br><span class="line">    custom-network-config # path to yolo config</span><br><span class="line">    model-file # path to yolo weights</span><br><span class="line">- Enable INT8 precision detection if there is a calibration cache file, update</span><br><span class="line">  config_infer_primary_yolo[...].txt.</span><br><span class="line">    int8-calib-file=yolo[...]-calibration.table.trt5.1</span><br><span class="line">- Other INT8 precision calibration table need to be calibrated by user.</span><br><span class="line">- The yolo-tlt sample makes use of a few TensorRT OSS plugins. Download the</span><br><span class="line">  TensorRT OSS repo (https://github.com/NVIDIA/TensorRT/) and checkout the</span><br><span class="line">  &#x27;release/7.0&#x27; branch. Follow the instructions in the README to build the</span><br><span class="line">  plugin library &#x27;libnvinfer_plugin.so.7.0.0&#x27; corresponding to your dGPU/Jetson</span><br><span class="line">  platform. This library needs to be used with LD_PRELOAD to let nvinfer plugin</span><br><span class="line">  access the TRT OSS plugin layers.</span><br><span class="line">- Set the path of the etlt model (tlt-encoded-model) and the tlt model key</span><br><span class="line">  (tlt-model-key) in config_infer_primary_yolo_tlt.txt before running the sample.</span><br></pre></td></tr></table></figure><p><strong>ç¼–è¯‘å·¥ç¨‹</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Compile the custom library:</span><br><span class="line">  # Based on the API to use &#x27;NvDsInferCreateModelParser&#x27; or &#x27;NvDsInferCudaEngineGet&#x27;</span><br><span class="line">  # set the macro USE_CUDA_ENGINE_GET_API to 0 or 1 in</span><br><span class="line">  # nvdsinfer_custom_impl_Yolo/nvdsinfer_yolo_engine.cpp</span><br><span class="line"></span><br><span class="line">  # Export correct CUDA version (e.g. 10.2, 10.1)</span><br><span class="line">  $ export CUDA_VER=10.2</span><br><span class="line">  $ make -C nvdsinfer_custom_impl_Yolo</span><br><span class="line">  è¿™æ—¶å€™ä¼šåœ¨nvdsinfer_custom_impl_Yoloæ–‡ä»¶å¤¹é‡Œç”Ÿæˆ.soæ–‡ä»¶</span><br></pre></td></tr></table></figure><p><strong>è¿è¡Œç¤ºä¾‹</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Run the sample:</span><br><span class="line">The &quot;nvinfer&quot; config file config_infer_primary_yolo.txt specifies the path to</span><br><span class="line">the custom library and the custom output parsing function through the properties</span><br><span class="line">&quot;custom-lib-path&quot; and &quot;parse-bbox-func-name&quot; respectively.</span><br><span class="line">The first-time a &quot;model_b1_int8.engine&quot; would be generated as the engine-file</span><br><span class="line"></span><br><span class="line">- With deepstream-app</span><br><span class="line">  $ deepstream-app -c deepstream_app_config_yoloV3.txt</span><br><span class="line">  $ deepstream-app -c deepstream_app_config_yoloV3_tiny.txt</span><br><span class="line">  $ deepstream-app -c deepstream_app_config_yoloV2.txt</span><br><span class="line">  $ deepstream-app -c deepstream_app_config_yoloV2_tiny.txt</span><br><span class="line">  $ LD_PRELOAD=&lt;path-to-TRT-OSS-libnvinfer_plugin.so.7.0.0&gt; deepstream-app -c deepstream_app_config_yolo_tlt.txt</span><br></pre></td></tr></table></figure><p><strong>æ£€æµ‹ç»“æœ</strong></p><p><img src="/2021/07/10/week-2-2/2-1.png" alt="1"></p><h3 id="ç¨‹åºæ³¨é‡Šå’Œç†è§£"><a href="#ç¨‹åºæ³¨é‡Šå’Œç†è§£" class="headerlink" title="ç¨‹åºæ³¨é‡Šå’Œç†è§£"></a>ç¨‹åºæ³¨é‡Šå’Œç†è§£</h3><p>è¯¥ç¨‹åºåˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š</p><ul><li><p>ä¸€éƒ¨åˆ†æ˜¯<code>tensorRT</code>éƒ¨åˆ† å°±æ˜¯<code>sources\objectDetector_Yolo</code>æ–‡ä»¶å¤¹é‡Œçš„ï¼Œç¼–è¯‘åä¼šç”Ÿäº§åŠ¨æ€åº“æ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯<code>libnvdsinfer_custom_impl_Yolo.so</code></p></li><li><p>å¦ä¸€éƒ¨åˆ†æ˜¯<code>deepstream</code>çš„æ–‡ä»¶ï¼Œåœ¨<code>sources\apps\sample_apps\deepstream-app</code>æ–‡ä»¶å¤¹é‡Œã€‚</p></li></ul><p>é¦–å…ˆè¯´æ˜ä¸‹<code>tensorRT</code>å‡ ä¸ªæ–‡ä»¶çš„å…³ç³»ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">|-- kernels.cucudaæ ¸æœ€åº•å±‚çš„å®ç°</span><br><span class="line">|-- nvdsinfer_yolo_engine.cppæ ¹æ®ç½‘ç»œç±»å‹åˆ›å»ºå¼•æ“,ç”Ÿæˆtensorrt engine</span><br><span class="line">|-- nvdsparsebbox_Yolo.cppyoloç›®æ ‡æ£€æµ‹ç»“æœçš„è¾“å‡º,æ¨ç†åçš„åå¤„ç†éƒ¨åˆ†</span><br><span class="line">|-- trt_utils.cppå»ºç«‹tensorRTç½‘ç»œçš„éƒ¨åˆ†</span><br><span class="line">|-- trt_utils.h</span><br><span class="line">|-- yolo.cppåˆ›å»ºå¼•æ“ã€åˆ›å»ºç½‘ç»œç­‰çš„å…·ä½“å®ç°</span><br><span class="line">|-- yolo.h</span><br><span class="line">|-- yoloPlugins.cppæ¨¡å‹æ­å»ºçš„ä¸€äº›ç»„ä»¶ä»¥åŠç›¸åº”çš„å®ç°</span><br><span class="line">|-- yoloPlugins.h</span><br></pre></td></tr></table></figure><p><img src="/2021/07/10/week-2-2/2-2.png" alt="1"></p><p>å…¶ä¸­yolo.cppå®ç°äº†ç½‘ç»œå±‚çš„æ­å»ºï¼Œæ˜¯æ ¸å¿ƒä»£ç éƒ¨åˆ†,ä¸‹é¢ä»£ç å®ç°äº†å·ç§¯å±‚çš„æ­å»ºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¦‚æœæ˜¯å·ç§¯å±‚</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (m_ConfigBlocks.at(i).at(<span class="string">&quot;type&quot;</span>) == <span class="string">&quot;convolutional&quot;</span>) &#123;</span><br><span class="line">    <span class="comment">//è·å–tensorçš„å¤§å°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> inputVol = dimsToString(previous-&gt;getDimensions());</span><br><span class="line">    nvinfer1::ILayer* out;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> layerType;<span class="comment">//ä¿å­˜ç½‘ç»œç±»å‹</span></span><br><span class="line">    <span class="comment">// check if batch_norm enabled</span></span><br><span class="line">    <span class="keyword">if</span> (m_ConfigBlocks.at(i).find(<span class="string">&quot;batch_normalize&quot;</span>) !=</span><br><span class="line">    m_ConfigBlocks.at(i).end()) &#123;</span><br><span class="line">    <span class="comment">//æœ‰BNçš„å·ç§¯å±‚</span></span><br><span class="line">    out = netAddConvBNLeaky(i, m_ConfigBlocks.at(i), weights,</span><br><span class="line">    m_TrtWeights, weightPtr, channels, previous, &amp;network);</span><br><span class="line">    layerType = <span class="string">&quot;conv-bn-leaky&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">    out = netAddConvLinear(i, m_ConfigBlocks.at(i), weights,</span><br><span class="line">    m_TrtWeights, weightPtr, channels, previous, &amp;network);</span><br><span class="line">    layerType = <span class="string">&quot;conv-linear&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    previous = out-&gt;getOutput(<span class="number">0</span>);<span class="comment">//è·å–è¯¥å±‚çš„è¾“å‡º</span></span><br><span class="line">    assert(previous != <span class="literal">nullptr</span>);</span><br><span class="line">    channels = getNumChannels(previous);</span><br><span class="line">    <span class="comment">//è·å–tensorçš„å¤§å°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> outputVol = dimsToString(previous-&gt;getDimensions());</span><br><span class="line">    <span class="comment">//ä¿å­˜ç›¸åº”çš„å±‚è¾“å‡º</span></span><br><span class="line">    tensorOutputs.push_back(out-&gt;getOutput(<span class="number">0</span>));</span><br><span class="line">    <span class="comment">//æ‰“å°å‚æ•°</span></span><br><span class="line">    printLayerInfo(layerIndex, layerType, inputVol, outputVol, <span class="built_in">std</span>::to_string(weightPtr));</span><br></pre></td></tr></table></figure><p>ä¸‹é¢è¯´æ˜ä¸€ä¸‹deepstreaméƒ¨åˆ†ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">|-- deepstream-app</span><br><span class="line">|   |-- Makefile</span><br><span class="line">|   |-- README</span><br><span class="line">|   |-- deepstream_app.cpipelineçš„ä¸€äº›æ“ä½œåœ¨è¿™é‡Œ</span><br><span class="line">|   |-- deepstream_app.h</span><br><span class="line">|   |-- deepstream_app_config_parser.c é…ç½®æ–‡ä»¶çš„è§£æ</span><br><span class="line">|   |-- deepstream_app_main.c deepstreamä¸»å‡½æ•°</span><br><span class="line"></span><br><span class="line">deepstreamä¼šè°ƒç”¨åŠ¨æ€åº“æ–‡ä»¶libnvdsinfer_custom_impl_Yolo.soå®ç°ç½‘ç»œå±‚çš„æ­å»ºç­‰åŠŸèƒ½</span><br></pre></td></tr></table></figure><p>å†æ¥çœ‹ä¸‹deepstream_app_main.cä¸»å‡½æ•°éƒ¨åˆ†çš„ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span></span></span><br><span class="line"><span class="function"><span class="title">main</span> <span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  GOptionContext *ctx = <span class="literal">NULL</span>;</span><br><span class="line">  GOptionGroup *group = <span class="literal">NULL</span>;</span><br><span class="line">  GError *error = <span class="literal">NULL</span>;</span><br><span class="line">  guint i;</span><br><span class="line">  ctx = g_option_context_new (<span class="string">&quot;Nvidia DeepStream Demo&quot;</span>);</span><br><span class="line">  group = g_option_group_new (<span class="string">&quot;abc&quot;</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">  g_option_group_add_entries (group, entries);  <span class="comment">//æŠŠentriesæ·»åŠ åˆ°group</span></span><br><span class="line">  g_option_context_set_main_group (ctx, group); <span class="comment">//groupæ·»åŠ åˆ°ctx</span></span><br><span class="line">  g_option_context_add_group (ctx, gst_init_get_option_group ());</span><br><span class="line">  GST_DEBUG_CATEGORY_INIT (NVDS_APP, <span class="string">&quot;NVDS_APP&quot;</span>, <span class="number">0</span>, <span class="literal">NULL</span>);   </span><br><span class="line">  <span class="comment">// è§£æå‘½ä»¤è¡Œå‚æ•°ï¼Œè¯†åˆ«å·²æ·»åŠ åˆ°ä¸Šä¸‹æ–‡çš„é€‰é¡¹</span></span><br><span class="line">  <span class="keyword">if</span> (!g_option_context_parse (ctx, &amp;argc, &amp;argv, &amp;error)) &#123;</span><br><span class="line">    NVGSTDS_ERR_MSG_V (<span class="string">&quot;%s&quot;</span>, error-&gt;message);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (print_version) &#123;</span><br><span class="line">    g_print (<span class="string">&quot;deepstream-app version %d.%d.%d\n&quot;</span>,</span><br><span class="line">        NVDS_APP_VERSION_MAJOR, NVDS_APP_VERSION_MINOR, NVDS_APP_VERSION_MICRO);</span><br><span class="line">    nvds_version_print ();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (print_dependencies_version) &#123;</span><br><span class="line">    g_print (<span class="string">&quot;deepstream-app version %d.%d.%d\n&quot;</span>,</span><br><span class="line">        NVDS_APP_VERSION_MAJOR, NVDS_APP_VERSION_MINOR, NVDS_APP_VERSION_MICRO);</span><br><span class="line">    nvds_version_print ();</span><br><span class="line">    nvds_dependencies_version_print ();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (cfg_files) &#123;<span class="comment">//ä¸€èˆ¬æ‰§è¡Œè¿™é¡¹</span></span><br><span class="line">    num_instances = g_strv_length (cfg_files);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (input_files) &#123;</span><br><span class="line">    num_input_files = g_strv_length (input_files);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!cfg_files || num_instances == <span class="number">0</span>) &#123;</span><br><span class="line">    NVGSTDS_ERR_MSG_V (<span class="string">&quot;Specify config file with -c option&quot;</span>);</span><br><span class="line">    return_value = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">goto</span> done;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_instances; i++) &#123;</span><br><span class="line">    appCtx[i] = g_malloc0 (<span class="keyword">sizeof</span> (AppCtx));</span><br><span class="line">    appCtx[i]-&gt;person_class_id = <span class="number">-1</span>;</span><br><span class="line">    appCtx[i]-&gt;car_class_id = <span class="number">-1</span>;</span><br><span class="line">    appCtx[i]-&gt;index = i;</span><br><span class="line">    appCtx[i]-&gt;active_source_index = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> (show_bbox_text) &#123;</span><br><span class="line">      appCtx[i]-&gt;show_bbox_text = TRUE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (input_files &amp;&amp; input_files[i]) &#123;</span><br><span class="line">      appCtx[i]-&gt;config.multi_source_config[<span class="number">0</span>].uri =</span><br><span class="line">          g_strdup_printf (<span class="string">&quot;file://%s&quot;</span>, input_files[i]);</span><br><span class="line">      g_free (input_files[i]);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// è§£æé…ç½®æ–‡ä»¶å†…å®¹ï¼Œè¿™æ˜¯ä¸ªé‡ç‚¹å‡½æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (!parse_config_file (&amp;appCtx[i]-&gt;config, cfg_files[i])) &#123;</span><br><span class="line">      NVGSTDS_ERR_MSG_V (<span class="string">&quot;Failed to parse config file &#x27;%s&#x27;&quot;</span>, cfg_files[i]);</span><br><span class="line">      appCtx[i]-&gt;return_value = <span class="number">-1</span>;</span><br><span class="line">      <span class="keyword">goto</span> done;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// é’ˆå¯¹é…ç½®è¿›è¡Œåˆ›å»ºpipelineï¼Œè¿™é‡Œæ˜¯å…³é”®éƒ¨åˆ†deepstreaméƒ¨åˆ†</span></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_instances; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!create_pipeline (appCtx[i], <span class="literal">NULL</span>,</span><br><span class="line">            all_bbox_generated, perf_cb, overlay_graphics)) &#123;</span><br><span class="line">      NVGSTDS_ERR_MSG_V (<span class="string">&quot;Failed to create pipeline&quot;</span>);</span><br><span class="line">      return_value = <span class="number">-1</span>;</span><br><span class="line">      <span class="keyword">goto</span> done;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  main_loop = g_main_loop_new (<span class="literal">NULL</span>, FALSE);</span><br><span class="line">  _intr_setup ();</span><br><span class="line">  g_timeout_add (<span class="number">400</span>, check_for_interrupt, <span class="literal">NULL</span>);</span><br><span class="line">  g_mutex_init (&amp;disp_lock);</span><br><span class="line">  <span class="comment">// è¿™éƒ¨åˆ†æ˜¯æ˜¾ç¤ºç›¸å…³çš„å†…å®¹</span></span><br><span class="line">  display = XOpenDisplay (<span class="literal">NULL</span>);</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_instances; i++) &#123;</span><br><span class="line">    guint j;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (gst_element_set_state (appCtx[i]-&gt;pipeline.pipeline,</span><br><span class="line">            GST_STATE_PAUSED) == GST_STATE_CHANGE_FAILURE) &#123;</span><br><span class="line">      NVGSTDS_ERR_MSG_V (<span class="string">&quot;Failed to set pipeline to PAUSED&quot;</span>);</span><br><span class="line">      return_value = <span class="number">-1</span>;</span><br><span class="line">      <span class="keyword">goto</span> done;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!appCtx[i]-&gt;config.tiled_display_config.enable)</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; appCtx[i]-&gt;config.num_sink_sub_bins; j++) &#123;</span><br><span class="line">      XTextProperty xproperty;</span><br><span class="line">      gchar *title;</span><br><span class="line">      guint width, height;</span><br><span class="line">      XSizeHints hints = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">      <span class="keyword">if</span> (!GST_IS_VIDEO_OVERLAY (appCtx[i]-&gt;pipeline.instance_bins[<span class="number">0</span>].</span><br><span class="line">              sink_bin.sub_bins[j].sink)) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (!display) &#123;</span><br><span class="line">        NVGSTDS_ERR_MSG_V (<span class="string">&quot;Could not open X Display&quot;</span>);</span><br><span class="line">        return_value = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">goto</span> done;</span><br><span class="line">      &#125;</span><br><span class="line">  <span class="comment">// æ˜¾ç¤ºè®¾ç½®</span></span><br><span class="line">      <span class="keyword">if</span> (appCtx[i]-&gt;config.sink_bin_sub_bin_config[j].render_config.width)</span><br><span class="line">        width =</span><br><span class="line">            appCtx[i]-&gt;config.sink_bin_sub_bin_config[j].render_config.width;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        width = appCtx[i]-&gt;config.tiled_display_config.width;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (appCtx[i]-&gt;config.sink_bin_sub_bin_config[j].render_config.height)</span><br><span class="line">        height =</span><br><span class="line">            appCtx[i]-&gt;config.sink_bin_sub_bin_config[j].render_config.height;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        height = appCtx[i]-&gt;config.tiled_display_config.height;</span><br><span class="line">      width = (width) ? width : DEFAULT_X_WINDOW_WIDTH;</span><br><span class="line">      height = (height) ? height : DEFAULT_X_WINDOW_HEIGHT;</span><br><span class="line">      hints.flags = PPosition | PSize;</span><br><span class="line">      hints.x = appCtx[i]-&gt;config.sink_bin_sub_bin_config[j].render_config.offset_x;</span><br><span class="line">      hints.y = appCtx[i]-&gt;config.sink_bin_sub_bin_config[j].render_config.offset_y;</span><br><span class="line">      hints.width = width;</span><br><span class="line">      hints.height = height;</span><br><span class="line">      windows[i] =</span><br><span class="line">          XCreateSimpleWindow (display, RootWindow (display,</span><br><span class="line">              DefaultScreen (display)), hints.x, hints.y, width, height, <span class="number">2</span>,</span><br><span class="line">              <span class="number">0x00000000</span>, <span class="number">0x00000000</span>);</span><br><span class="line">      XSetNormalHints(display, windows[i], &amp;hints);</span><br><span class="line">      <span class="keyword">if</span> (num_instances &gt; <span class="number">1</span>)</span><br><span class="line">        title = g_strdup_printf (APP_TITLE <span class="string">&quot;-%d&quot;</span>, i);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        title = g_strdup (APP_TITLE);</span><br><span class="line">      <span class="keyword">if</span> (XStringListToTextProperty ((<span class="keyword">char</span> **) &amp;title, <span class="number">1</span>, &amp;xproperty) != <span class="number">0</span>) &#123;</span><br><span class="line">        XSetWMName (display, windows[i], &amp;xproperty);</span><br><span class="line">        XFree (xproperty.value);</span><br><span class="line">      &#125;</span><br><span class="line">      XSetWindowAttributes attr = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">      <span class="keyword">if</span> ((appCtx[i]-&gt;config.tiled_display_config.enable &amp;&amp;</span><br><span class="line">              appCtx[i]-&gt;config.tiled_display_config.rows *</span><br><span class="line">              appCtx[i]-&gt;config.tiled_display_config.columns == <span class="number">1</span>) ||</span><br><span class="line">          (appCtx[i]-&gt;config.tiled_display_config.enable == <span class="number">0</span> &amp;&amp;</span><br><span class="line">              appCtx[i]-&gt;config.num_source_sub_bins == <span class="number">1</span>)) &#123;</span><br><span class="line">        attr.event_mask = KeyPress;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        attr.event_mask = ButtonPress | KeyRelease;</span><br><span class="line">      &#125;</span><br><span class="line">      XChangeWindowAttributes (display, windows[i], CWEventMask, &amp;attr);</span><br><span class="line"></span><br><span class="line">      Atom wmDeleteMessage = XInternAtom (display, <span class="string">&quot;WM_DELETE_WINDOW&quot;</span>, False);</span><br><span class="line">      <span class="keyword">if</span> (wmDeleteMessage != None) &#123;</span><br><span class="line">        XSetWMProtocols (display, windows[i], &amp;wmDeleteMessage, <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      XMapRaised (display, windows[i]);</span><br><span class="line">      XSync (display, <span class="number">1</span>);       <span class="comment">//discard the events for now</span></span><br><span class="line">      gst_video_overlay_set_window_handle (GST_VIDEO_OVERLAY (appCtx</span><br><span class="line">              [i]-&gt;pipeline.instance_bins[<span class="number">0</span>].sink_bin.sub_bins[j].sink),</span><br><span class="line">          (gulong) windows[i]);</span><br><span class="line">      gst_video_overlay_expose (GST_VIDEO_OVERLAY (appCtx[i]-&gt;</span><br><span class="line">              pipeline.instance_bins[<span class="number">0</span>].sink_bin.sub_bins[j].sink));</span><br><span class="line">      <span class="keyword">if</span> (!x_event_thread)</span><br><span class="line">        x_event_thread = g_thread_new (<span class="string">&quot;nvds-window-event-thread&quot;</span>,</span><br><span class="line">            nvds_x_event_thread, <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/* Dont try to set playing state if error is observed */</span> </span><br><span class="line">  <span class="comment">// å‘ç”Ÿé”™è¯¯çš„å¤„ç†</span></span><br><span class="line">  <span class="keyword">if</span> (return_value != <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_instances; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (gst_element_set_state (appCtx[i]-&gt;pipeline.pipeline,</span><br><span class="line">              GST_STATE_PLAYING) == GST_STATE_CHANGE_FAILURE) &#123;</span><br><span class="line"></span><br><span class="line">        g_print (<span class="string">&quot;\ncan&#x27;t set pipeline to playing state.\n&quot;</span>);</span><br><span class="line">        return_value = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">goto</span> done;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  print_runtime_commands ();</span><br><span class="line">  changemode (<span class="number">1</span>);</span><br><span class="line">  g_timeout_add (<span class="number">40</span>, event_thread_func, <span class="literal">NULL</span>);</span><br><span class="line">  g_main_loop_run (main_loop);</span><br><span class="line">  changemode (<span class="number">0</span>);</span><br><span class="line">done:</span><br><span class="line">  g_print (<span class="string">&quot;Quitting\n&quot;</span>);</span><br><span class="line">  <span class="comment">// ä¸‹é¢æ˜¯é‡Šæ”¾èµ„æº</span></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_instances; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (appCtx[i]-&gt;return_value == <span class="number">-1</span>)</span><br><span class="line">      return_value = <span class="number">-1</span>;</span><br><span class="line">    destroy_pipeline (appCtx[i]);</span><br><span class="line"></span><br><span class="line">    g_mutex_lock (&amp;disp_lock);</span><br><span class="line">    <span class="keyword">if</span> (windows[i])</span><br><span class="line">      XDestroyWindow (display, windows[i]);</span><br><span class="line">    windows[i] = <span class="number">0</span>;</span><br><span class="line">    g_mutex_unlock (&amp;disp_lock);</span><br><span class="line">    g_free (appCtx[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  g_mutex_lock (&amp;disp_lock);</span><br><span class="line">  <span class="keyword">if</span> (display)</span><br><span class="line">    XCloseDisplay (display);</span><br><span class="line">  display = <span class="literal">NULL</span>;</span><br><span class="line">  g_mutex_unlock (&amp;disp_lock);</span><br><span class="line">  g_mutex_clear (&amp;disp_lock);</span><br><span class="line">  <span class="keyword">if</span> (main_loop) &#123;</span><br><span class="line">    g_main_loop_unref (main_loop);<span class="comment">//æ‰§è¡Œå¾ªç¯æ¨ç†</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (ctx) &#123;</span><br><span class="line">    g_option_context_free (ctx);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (return_value == <span class="number">0</span>) &#123;</span><br><span class="line">    g_print (<span class="string">&quot;App run successful\n&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    g_print (<span class="string">&quot;App run failed\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  gst_deinit ();</span><br><span class="line">  <span class="keyword">return</span> return_value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¯<code>deepstream_app_config_parser.c</code>è§£æé…ç½®æ–‡ä»¶çš„ä»£ç ï¼Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">gboolean</span></span><br><span class="line"><span class="function"><span class="title">parse_config_file</span> <span class="params">(NvDsConfig *config, gchar *cfg_file_path)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  GKeyFile *cfg_file = g_key_file_new ();</span><br><span class="line">  GError *error = <span class="literal">NULL</span>;</span><br><span class="line">  gboolean ret = FALSE;</span><br><span class="line">  gchar **groups = <span class="literal">NULL</span>;</span><br><span class="line">  gchar **group;</span><br><span class="line">  guint i, j;</span><br><span class="line"></span><br><span class="line">  config-&gt;source_list_enabled = FALSE;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!APP_CFG_PARSER_CAT) &#123;</span><br><span class="line">    GST_DEBUG_CATEGORY_INIT (APP_CFG_PARSER_CAT, <span class="string">&quot;NVDS_CFG_PARSER&quot;</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!g_key_file_load_from_file (cfg_file, cfg_file_path, G_KEY_FILE_NONE,</span><br><span class="line">          &amp;error)) &#123;</span><br><span class="line">    GST_CAT_ERROR (APP_CFG_PARSER_CAT, <span class="string">&quot;Failed to load uri file: %s&quot;</span>,</span><br><span class="line">        error-&gt;message);</span><br><span class="line">    <span class="keyword">goto</span> done;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (g_key_file_has_group (cfg_file, CONFIG_GROUP_SOURCE_LIST)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!parse_source_list (config, cfg_file, cfg_file_path)) &#123;</span><br><span class="line">      GST_CAT_ERROR (APP_CFG_PARSER_CAT, <span class="string">&quot;Failed to parse &#x27;%s&#x27; group&quot;</span>,</span><br><span class="line">          CONFIG_GROUP_SOURCE_LIST);</span><br><span class="line">      <span class="keyword">goto</span> done;</span><br><span class="line">    &#125;</span><br><span class="line">    config-&gt;num_source_sub_bins = config-&gt;total_num_sources;</span><br><span class="line">    config-&gt;source_list_enabled = TRUE;</span><br><span class="line">    <span class="keyword">if</span> (!g_key_file_has_group (cfg_file, CONFIG_GROUP_SOURCE_ALL)) &#123;</span><br><span class="line">      NVGSTDS_ERR_MSG_V (<span class="string">&quot;[source-attr-all] group not present.&quot;</span>);</span><br><span class="line">      ret = FALSE;</span><br><span class="line">      <span class="keyword">goto</span> done;</span><br><span class="line">    &#125;</span><br><span class="line">    g_key_file_remove_group (cfg_file, CONFIG_GROUP_SOURCE_LIST, &amp;error);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (g_key_file_has_group (cfg_file, CONFIG_GROUP_SOURCE_ALL)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!parse_source (&amp;global_source_config,</span><br><span class="line">            cfg_file, CONFIG_GROUP_SOURCE_ALL, cfg_file_path)) &#123;</span><br><span class="line">      GST_CAT_ERROR (APP_CFG_PARSER_CAT, <span class="string">&quot;Failed to parse &#x27;%s&#x27; group&quot;</span>,</span><br><span class="line">          CONFIG_GROUP_SOURCE_LIST);</span><br><span class="line">      <span class="keyword">goto</span> done;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!set_source_all_configs (config, cfg_file_path)) &#123;</span><br><span class="line">      ret = FALSE;</span><br><span class="line">      <span class="keyword">goto</span> done;</span><br><span class="line">    &#125;</span><br><span class="line">    g_key_file_remove_group (cfg_file, CONFIG_GROUP_SOURCE_ALL, &amp;error);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ä¿¡æ¯å­˜å‚¨åœ¨é‡Œcfg_fileé‡Œé¢</span></span><br><span class="line">  groups = g_key_file_get_groups (cfg_file, <span class="literal">NULL</span>);</span><br><span class="line">  <span class="comment">//è¿™é‡Œå¯¹åº”çš„æ˜¯8é¡¹  </span></span><br><span class="line">  <span class="comment">//group[0]=application</span></span><br><span class="line">  <span class="comment">//group[1]=tiled-display</span></span><br><span class="line">  <span class="comment">//group[2]=source0</span></span><br><span class="line">  <span class="comment">//group[3]=sink0</span></span><br><span class="line">  <span class="comment">//group[4]=osd</span></span><br><span class="line">  <span class="comment">//group[5]=streammux</span></span><br><span class="line">  <span class="comment">//group[6]=primary-gie</span></span><br><span class="line">  <span class="comment">//group[7]=tracker</span></span><br><span class="line">  <span class="comment">//group[8]=tests</span></span><br><span class="line">  <span class="keyword">for</span> (group = groups; *group; group++) &#123;</span><br><span class="line">    gboolean parse_err = FALSE;</span><br><span class="line">    GST_CAT_DEBUG (APP_CFG_PARSER_CAT, <span class="string">&quot;Parsing group: %s&quot;</span>, *group);</span><br><span class="line">    <span class="comment">// application </span></span><br><span class="line">    <span class="keyword">if</span> (!g_strcmp0 (*group, CONFIG_GROUP_APP)) &#123;</span><br><span class="line">      parse_err = !parse_app (config, cfg_file, cfg_file_path);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// source0  </span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">strncmp</span> (*group, CONFIG_GROUP_SOURCE,</span><br><span class="line">            <span class="keyword">sizeof</span> (CONFIG_GROUP_SOURCE) - <span class="number">1</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (config-&gt;num_source_sub_bins == MAX_SOURCE_BINS) &#123;</span><br><span class="line">        NVGSTDS_ERR_MSG_V (<span class="string">&quot;App supports max %d sources&quot;</span>, MAX_SOURCE_BINS);</span><br><span class="line">        ret = FALSE;</span><br><span class="line">        <span class="keyword">goto</span> done;</span><br><span class="line">      &#125;</span><br><span class="line">      gchar *source_id_start_ptr = *group + <span class="built_in">strlen</span> (CONFIG_GROUP_SOURCE);</span><br><span class="line">      gchar *source_id_end_ptr = <span class="literal">NULL</span>;</span><br><span class="line">      guint index =</span><br><span class="line">          g_ascii_strtoull (source_id_start_ptr, &amp;source_id_end_ptr, <span class="number">10</span>);</span><br><span class="line">      <span class="keyword">if</span> (source_id_start_ptr == source_id_end_ptr</span><br><span class="line">          || *source_id_end_ptr != <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">        NVGSTDS_ERR_MSG_V</span><br><span class="line">            (<span class="string">&quot;Source group \&quot;[%s]\&quot; is not in the form \&quot;[source&lt;%%d&gt;]\&quot;&quot;</span>,</span><br><span class="line">            *group);</span><br><span class="line">        ret = FALSE;</span><br><span class="line">        <span class="keyword">goto</span> done;</span><br><span class="line">      &#125;</span><br><span class="line">      guint source_id = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span> (config-&gt;source_list_enabled) &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &gt;= config-&gt;total_num_sources) &#123;</span><br><span class="line">          NVGSTDS_ERR_MSG_V</span><br><span class="line">              (<span class="string">&quot;Invalid source group index %d, index cannot exceed %d&quot;</span>, index,</span><br><span class="line">              config-&gt;total_num_sources);</span><br><span class="line">          ret = FALSE;</span><br><span class="line">          <span class="keyword">goto</span> done;</span><br><span class="line">        &#125;</span><br><span class="line">        source_id = index;</span><br><span class="line">        NVGSTDS_INFO_MSG_V (<span class="string">&quot;Some parameters to be overwritten for group [%s]&quot;</span>,</span><br><span class="line">            *group);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        source_id = config-&gt;num_source_sub_bins;</span><br><span class="line">      &#125;</span><br><span class="line">      parse_err = !parse_source (&amp;config-&gt;multi_source_config[source_id],</span><br><span class="line">          cfg_file, *group, cfg_file_path);</span><br><span class="line">      <span class="keyword">if</span> (config-&gt;source_list_enabled</span><br><span class="line">          &amp;&amp; config-&gt;multi_source_config[source_id].type ==</span><br><span class="line">          NV_DS_SOURCE_URI_MULTIPLE) &#123;</span><br><span class="line">        NVGSTDS_ERR_MSG_V</span><br><span class="line">            (<span class="string">&quot;MultiURI support not available if [source-list] is provided&quot;</span>);</span><br><span class="line">        ret = FALSE;</span><br><span class="line">        <span class="keyword">goto</span> done;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (config-&gt;multi_source_config[source_id].enable</span><br><span class="line">          &amp;&amp; !config-&gt;source_list_enabled) &#123;</span><br><span class="line">        config-&gt;num_source_sub_bins++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// streammux</span></span><br><span class="line">    <span class="keyword">if</span> (!g_strcmp0 (*group, CONFIG_GROUP_STREAMMUX)) &#123;</span><br><span class="line">      <span class="comment">// å­˜å‚¨åˆ°config-&gt;streammux_configä¸­</span></span><br><span class="line">      parse_err = !parse_streammux (&amp;config-&gt;streammux_config, cfg_file, cfg_file_path);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// osd</span></span><br><span class="line">    <span class="keyword">if</span> (!g_strcmp0 (*group, CONFIG_GROUP_OSD)) &#123;</span><br><span class="line">      parse_err = !parse_osd (&amp;config-&gt;osd_config, cfg_file);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// primary_gie</span></span><br><span class="line">    <span class="keyword">if</span> (!g_strcmp0 (*group, CONFIG_GROUP_PRIMARY_GIE)) &#123;</span><br><span class="line">      parse_err =</span><br><span class="line">          !parse_gie (&amp;config-&gt;primary_gie_config, cfg_file,</span><br><span class="line">          CONFIG_GROUP_PRIMARY_GIE, cfg_file_path);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!g_strcmp0 (*group, CONFIG_GROUP_TRACKER)) &#123;</span><br><span class="line">      parse_err = !parse_tracker (&amp;config-&gt;tracker_config, cfg_file, cfg_file_path);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">strncmp</span> (*group, CONFIG_GROUP_SECONDARY_GIE,</span><br><span class="line">                  <span class="keyword">sizeof</span> (CONFIG_GROUP_SECONDARY_GIE) - <span class="number">1</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (config-&gt;num_secondary_gie_sub_bins == MAX_SECONDARY_GIE_BINS) &#123;</span><br><span class="line">        NVGSTDS_ERR_MSG_V (<span class="string">&quot;App supports max %d secondary GIEs&quot;</span>, MAX_SECONDARY_GIE_BINS);</span><br><span class="line">        ret = FALSE;</span><br><span class="line">        <span class="keyword">goto</span> done;</span><br><span class="line">      &#125;</span><br><span class="line">      parse_err =</span><br><span class="line">          !parse_gie (&amp;config-&gt;secondary_gie_sub_bin_config[config-&gt;</span><br><span class="line">                                  num_secondary_gie_sub_bins],</span><br><span class="line">                                  cfg_file, *group, cfg_file_path);</span><br><span class="line">      <span class="keyword">if</span> (config-&gt;secondary_gie_sub_bin_config[config-&gt;num_secondary_gie_sub_bins].enable)&#123;</span><br><span class="line">        config-&gt;num_secondary_gie_sub_bins++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">strncmp</span> (*group, CONFIG_GROUP_SINK, <span class="keyword">sizeof</span> (CONFIG_GROUP_SINK) - <span class="number">1</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (config-&gt;num_sink_sub_bins == MAX_SINK_BINS) &#123;</span><br><span class="line">        NVGSTDS_ERR_MSG_V (<span class="string">&quot;App supports max %d sinks&quot;</span>, MAX_SINK_BINS);</span><br><span class="line">        ret = FALSE;</span><br><span class="line">        <span class="keyword">goto</span> done;</span><br><span class="line">      &#125;</span><br><span class="line">      parse_err =</span><br><span class="line">          !parse_sink (&amp;config-&gt;</span><br><span class="line">          sink_bin_sub_bin_config[config-&gt;num_sink_sub_bins], cfg_file, *group,</span><br><span class="line">          cfg_file_path);</span><br><span class="line">      <span class="keyword">if</span> (config-&gt;</span><br><span class="line">          sink_bin_sub_bin_config[config-&gt;num_sink_sub_bins].enable)&#123;</span><br><span class="line">        config-&gt;num_sink_sub_bins++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">strncmp</span> (*group, CONFIG_GROUP_MSG_CONSUMER,</span><br><span class="line">        <span class="keyword">sizeof</span> (CONFIG_GROUP_MSG_CONSUMER) - <span class="number">1</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (config-&gt;num_message_consumers == MAX_MESSAGE_CONSUMERS) &#123;</span><br><span class="line">        NVGSTDS_ERR_MSG_V (<span class="string">&quot;App supports max %d consumers&quot;</span>, MAX_MESSAGE_CONSUMERS);</span><br><span class="line">        ret = FALSE;</span><br><span class="line">        <span class="keyword">goto</span> done;</span><br><span class="line">      &#125;</span><br><span class="line">      parse_err = !parse_msgconsumer (</span><br><span class="line">                    &amp;config-&gt;message_consumer_config[config-&gt;num_message_consumers],</span><br><span class="line">                    cfg_file, *group, cfg_file_path);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (config-&gt;message_consumer_config[config-&gt;num_message_consumers].enable) &#123;</span><br><span class="line">        config-&gt;num_message_consumers++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// tiled-display</span></span><br><span class="line">    <span class="keyword">if</span> (!g_strcmp0 (*group, CONFIG_GROUP_TILED_DISPLAY)) &#123;</span><br><span class="line">      parse_err = !parse_tiled_display (&amp;config-&gt;tiled_display_config, cfg_file);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (!g_strcmp0 (*group, CONFIG_GROUP_IMG_SAVE)) &#123;</span><br><span class="line">      parse_err = !parse_image_save (&amp;config-&gt;image_save_config , cfg_file, *group, cfg_file_path);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!g_strcmp0 (*group, CONFIG_GROUP_DSANALYTICS)) &#123;</span><br><span class="line">      parse_err = !parse_dsanalytics (&amp;config-&gt;dsanalytics_config, cfg_file, cfg_file_path);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!g_strcmp0 (*group, CONFIG_GROUP_DSEXAMPLE)) &#123;</span><br><span class="line">      parse_err = !parse_dsexample (&amp;config-&gt;dsexample_config, cfg_file);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!g_strcmp0 (*group, CONFIG_GROUP_MSG_CONVERTER)) &#123;</span><br><span class="line">      parse_err = !parse_msgconv (&amp;config-&gt;msg_conv_config, cfg_file, *group, cfg_file_path);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// tests</span></span><br><span class="line">    <span class="keyword">if</span> (!g_strcmp0 (*group, CONFIG_GROUP_TESTS)) &#123;</span><br><span class="line">      parse_err = !parse_tests (config, cfg_file);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (parse_err) &#123;</span><br><span class="line">      GST_CAT_ERROR (APP_CFG_PARSER_CAT, <span class="string">&quot;Failed to parse &#x27;%s&#x27; group&quot;</span>, *group);</span><br><span class="line">      <span class="keyword">goto</span> done;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// äºŒçº§ç½‘ç»œå¤„ç†</span></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; config-&gt;num_secondary_gie_sub_bins; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (config-&gt;secondary_gie_sub_bin_config[i].unique_id ==</span><br><span class="line">        config-&gt;primary_gie_config.unique_id) &#123;</span><br><span class="line">      NVGSTDS_ERR_MSG_V (<span class="string">&quot;Non unique gie ids found&quot;</span>);</span><br><span class="line">      ret = FALSE;</span><br><span class="line">      <span class="keyword">goto</span> done;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; config-&gt;num_secondary_gie_sub_bins; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (j = i + <span class="number">1</span>; j &lt; config-&gt;num_secondary_gie_sub_bins; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (config-&gt;secondary_gie_sub_bin_config[i].unique_id ==</span><br><span class="line">          config-&gt;secondary_gie_sub_bin_config[j].unique_id) &#123;</span><br><span class="line">        NVGSTDS_ERR_MSG_V (<span class="string">&quot;Non unique gie id %d found&quot;</span>,</span><br><span class="line">                            config-&gt;secondary_gie_sub_bin_config[i].unique_id);</span><br><span class="line">        ret = FALSE;</span><br><span class="line">        <span class="keyword">goto</span> done;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å¤šè¾“å…¥æºå¤„ç†</span></span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; config-&gt;num_source_sub_bins; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (config-&gt;multi_source_config[i].type == NV_DS_SOURCE_URI_MULTIPLE) &#123;</span><br><span class="line">      <span class="keyword">if</span> (config-&gt;multi_source_config[i].num_sources &lt; <span class="number">1</span>) &#123;</span><br><span class="line">        config-&gt;multi_source_config[i].num_sources = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt; config-&gt;multi_source_config[i].num_sources; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (config-&gt;num_source_sub_bins == MAX_SOURCE_BINS) &#123;</span><br><span class="line">          NVGSTDS_ERR_MSG_V (<span class="string">&quot;App supports max %d sources&quot;</span>, MAX_SOURCE_BINS);</span><br><span class="line">          ret = FALSE;</span><br><span class="line">          <span class="keyword">goto</span> done;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memcpy</span> (&amp;config-&gt;multi_source_config[config-&gt;num_source_sub_bins],</span><br><span class="line">            &amp;config-&gt;multi_source_config[i],</span><br><span class="line">            <span class="keyword">sizeof</span> (config-&gt;multi_source_config[i]));</span><br><span class="line">        config-&gt;multi_source_config[config-&gt;num_source_sub_bins].type =</span><br><span class="line">            NV_DS_SOURCE_URI;</span><br><span class="line">        config-&gt;multi_source_config[config-&gt;num_source_sub_bins].uri =</span><br><span class="line">            g_strdup_printf (config-&gt;multi_source_config[config-&gt;</span><br><span class="line">                num_source_sub_bins].uri, j);</span><br><span class="line">        config-&gt;num_source_sub_bins++;</span><br><span class="line">      &#125;</span><br><span class="line">      config-&gt;multi_source_config[i].type = NV_DS_SOURCE_URI;</span><br><span class="line">      config-&gt;multi_source_config[i].uri =</span><br><span class="line">          g_strdup_printf (config-&gt;multi_source_config[i].uri, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ret = TRUE;</span><br><span class="line"></span><br><span class="line">done:</span><br><span class="line">  <span class="keyword">if</span> (cfg_file) &#123;</span><br><span class="line">    g_key_file_free (cfg_file);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (groups) &#123;</span><br><span class="line">    g_strfreev (groups);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (error) &#123;</span><br><span class="line">    g_error_free (error);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!ret) &#123;</span><br><span class="line">    NVGSTDS_ERR_MSG_V (<span class="string">&quot;%s failed&quot;</span>, __func__);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åæ˜¯å»ºç«‹<code>pipeline</code>çš„ä»£ç ï¼Œå»ºç«‹<code>pipeline</code>æ˜¯å±äº<code>deepstream</code>çš„éƒ¨åˆ†ï¼Œé‡Œé¢åŒ…å«äº†<code>tensorRT</code>çš„è°ƒç”¨ã€‚é…ç½®æ–‡ä»¶å½“ä¸­çš„<code>[primary-gie]</code>æ˜¯å¯¹æ¨ç†å¼•æ“çš„ç›¸å…³é…ç½®ã€‚ä¿®æ”¹é…ç½®æ–‡ä»¶å¯ä»¥å¯¹æ¨¡å‹å‚æ•°è¿›è¡Œè®¾ç½®ã€‚</p><h2 id="ä½¿ç”¨yolov3æ£€æµ‹å®‰å…¨å¸½ğŸ‘·"><a href="#ä½¿ç”¨yolov3æ£€æµ‹å®‰å…¨å¸½ğŸ‘·" class="headerlink" title="ä½¿ç”¨yolov3æ£€æµ‹å®‰å…¨å¸½ğŸ‘·"></a>ä½¿ç”¨yolov3æ£€æµ‹å®‰å…¨å¸½ğŸ‘·</h2><h3 id="æ•°æ®å‡†å¤‡"><a href="#æ•°æ®å‡†å¤‡" class="headerlink" title="æ•°æ®å‡†å¤‡"></a>æ•°æ®å‡†å¤‡</h3><p>æ¨¡å‹é…ç½®æ–‡ä»¶ï¼š<code>yolov3_half_helmet.cfg</code><br>æ¨¡å‹æƒé‡æ–‡ä»¶ï¼š<code>yolov3_half_helmet.weights</code><br>æ¨¡å‹ç±»åˆ«ï¼š3  ï¼Œ 0-æ­£å¸¸å¤´è‚©ï¼Œ1-ä¿å®‰å¤´è‚©ï¼Œ2-å®‰å…¨å¸½å¤´è‚© è§<code>helmet.names</code><br>æµ‹è¯•è§†é¢‘æ–‡ä»¶ï¼š<code>test_helmet_1.mp4</code>    <code> test_personcount.mp4</code></p><h3 id="æ£€æµ‹ä»»åŠ¡"><a href="#æ£€æµ‹ä»»åŠ¡" class="headerlink" title="æ£€æµ‹ä»»åŠ¡"></a>æ£€æµ‹ä»»åŠ¡</h3><p>â‘ ä½¿ç”¨<code>deepstream</code>æ„å»ºä¸€ä¸ª<code>pipeline</code>ï¼Œæ£€æµ‹<code>test_helmet_1.mp4</code>ï¼Œè¾“å‡ºç”»é¢ä¸­æ­£å¸¸å¤´è‚©ç”»çº¢æ¡†ï¼Œä¿å®‰å¤´è‚©ç”»è“æ¡†ï¼Œå®‰å…¨å¸½å¤´è‚©ç”»ç»¿æ¡†<br>â‘¡æµ‹è¯•å®‰å…¨å¸½æ£€æµ‹ å‰å¤„ç†ï¼Œæ¨ç†ï¼Œåå¤„ç†æ‰€ç”¨çš„æ—¶é—´<br>â‘¢ä½¿ç”¨<code>deepstream</code>æ„å»ºå¤šçº¿ç¨‹<code>pipeline</code>ï¼Œä½¿ç”¨å®‰å…¨å¸½æ£€æµ‹æ¨¡å‹åŒæ—¶æ£€æµ‹2ä¸ªè§†é¢‘æ–‡ä»¶</p><h3 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h3><p>å¯¹äºè‡ªå®šä¹‰æ•°æ®çš„æ£€æµ‹ï¼Œéœ€æ ¹æ®è‡ªå·±æ£€æµ‹çš„ç±»åˆ«ä¿®æ”¹å¦‚ä¸‹æ–‡ä»¶</p><p>ä¿®æ”¹<code>nvdsinfer_custom_impl_Yolo/nvdsparsebbox_Yolo.cpp</code>æ–‡ä»¶ä¸­æ£€æµ‹ç±»åˆ«</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># é»˜è®¤æ£€æµ‹cocoæ•°æ®é›†80ä¸ªç±»åˆ«ï¼Œä¿®æ”¹ä¸ºä½ è‡ªå·±æ£€æµ‹çš„ç±»åˆ«</span><br><span class="line">static const int NUM_CLASSES_YOLO = 3;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œä¿®æ”¹å®Œéœ€è¦é‡æ–°ç¼–è¯‘å’Œè¿è¡Œç”Ÿæˆé“¾æ¥çš„<code>.so</code>æ–‡ä»¶</p><p>ä¿®æ”¹<code>config_infer_primary_yoloV3.txt</code>æ–‡ä»¶ï¼Œä¿®æ”¹<code>cfg</code>å’Œ<code>weights</code>ç­‰æ–‡ä»¶ï¼Œæ ¹æ®è‡ªå·±æ£€æµ‹çš„ç±»åˆ«è®¾ç½®<code>num-detected-classes</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[property]</span><br><span class="line">gpu-id=0</span><br><span class="line">net-scale-factor=0.0039215697906911373</span><br><span class="line">#0=RGB, 1=BGR</span><br><span class="line">model-color-format=0</span><br><span class="line">#ä¿®æ”¹cfgæ–‡ä»¶</span><br><span class="line">custom-network-config=yolov3_half_helmet_20200607.cfg</span><br><span class="line">#ä¿®æ”¹weightsæ–‡ä»¶</span><br><span class="line">model-file=yolov3_half_helmet_20200607.weights</span><br><span class="line">#model-engine-file=yolov3_b1_gpu0_int8.engine</span><br><span class="line">#ä¿®æ”¹labelæ–‡ä»¶</span><br><span class="line">labelfile-path=helmet_names.txt</span><br><span class="line">int8-calib-file=yolov3-calibration.table.trt7.0</span><br><span class="line">## 0=FP32, 1=INT8, 2=FP16 mode</span><br><span class="line">network-mode=1</span><br><span class="line">#æ¨¡å‹ç±»åˆ«:3 0-æ­£å¸¸å¤´è‚©ï¼Œ1-ä¿å®‰å¤´è‚©ï¼Œ2-å®‰å…¨å¸½å¤´è‚©</span><br><span class="line">num-detected-classes=3</span><br><span class="line">gie-unique-id=1</span><br><span class="line">network-type=0</span><br><span class="line">is-classifier=0</span><br><span class="line">## 0=Group Rectangles, 1=DBSCAN, 2=NMS, 3= DBSCAN+NMS Hybrid, 4 = None(No clustering)</span><br><span class="line">cluster-mode=2</span><br><span class="line">maintain-aspect-ratio=1</span><br><span class="line">parse-bbox-func-name=NvDsInferParseCustomYoloV3</span><br><span class="line"># ç¼–è¯‘çš„åŠ¨æ€åº“è·¯å¾„</span><br><span class="line">custom-lib-path=nvdsinfer_custom_impl_Yolo/libnvdsinfer_custom_impl_Yolo.so</span><br><span class="line">engine-create-func-name=NvDsInferYoloCudaEngineGet</span><br><span class="line">#scaling-filter=0</span><br><span class="line">#scaling-compute-hw=0</span><br><span class="line"></span><br><span class="line">[class-attrs-all]</span><br><span class="line">nms-iou-threshold=0.3# NMSçš„é˜ˆå€¼</span><br><span class="line">#threshold=0.7</span><br><span class="line">pre-cluster-threshold=0.7   # æ£€æµ‹æ¡†çš„è¿‡æ»¤é˜ˆå€¼</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>deepstream_app_config_yoloV3.txt</code>æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">[application]</span><br><span class="line">enable-perf-measurement=1</span><br><span class="line">perf-measurement-interval-sec=5</span><br><span class="line">#gie-kitti-output-dir=streamscl</span><br><span class="line"></span><br><span class="line">[tiled-display]</span><br><span class="line">enable=1</span><br><span class="line">rows=1</span><br><span class="line">columns=1</span><br><span class="line">width=1280</span><br><span class="line">height=720</span><br><span class="line">gpu-id=0</span><br><span class="line">#(0): nvbuf-mem-default - Default memory allocated, specific to particular platform</span><br><span class="line">#(1): nvbuf-mem-cuda-pinned - Allocate Pinned/Host cuda memory, applicable for Tesla</span><br><span class="line">#(2): nvbuf-mem-cuda-device - Allocate Device cuda memory, applicable for Tesla</span><br><span class="line">#(3): nvbuf-mem-cuda-unified - Allocate Unified cuda memory, applicable for Tesla</span><br><span class="line">#(4): nvbuf-mem-surface-array - Allocate Surface Array memory, applicable for Jetson</span><br><span class="line">nvbuf-memory-type=0</span><br><span class="line"></span><br><span class="line">[source0]</span><br><span class="line">enable=1</span><br><span class="line">#Type - 1=CameraV4L2 2=URI 3=MultiURI</span><br><span class="line">type=3</span><br><span class="line"># ä¿®æ”¹æ–‡ä»¶ä½ç½®</span><br><span class="line">uri=file://../../samples/streams/test_helmet_1.mp4</span><br><span class="line">num-sources=1</span><br><span class="line">gpu-id=0</span><br><span class="line"># (0): memtype_device   - Memory type Device</span><br><span class="line"># (1): memtype_pinned   - Memory type Host Pinned</span><br><span class="line"># (2): memtype_unified  - Memory type Unified</span><br><span class="line">cudadec-memtype=0</span><br><span class="line"></span><br><span class="line">[sink0]</span><br><span class="line">enable=1</span><br><span class="line">#Type - 1=FakeSink 2=EglSink 3=File</span><br><span class="line">type=2</span><br><span class="line">sync=0</span><br><span class="line">source-id=0</span><br><span class="line">gpu-id=0</span><br><span class="line">nvbuf-memory-type=0</span><br><span class="line"></span><br><span class="line">[osd]</span><br><span class="line">enable=1</span><br><span class="line">gpu-id=0</span><br><span class="line">border-width=1</span><br><span class="line">text-size=15</span><br><span class="line">text-color=1;1;1;1;</span><br><span class="line">text-bg-color=0.3;0.3;0.3;1</span><br><span class="line">font=Serif</span><br><span class="line">show-clock=0</span><br><span class="line">clock-x-offset=800</span><br><span class="line">clock-y-offset=820</span><br><span class="line">clock-text-size=12</span><br><span class="line">clock-color=1;0;0;0</span><br><span class="line">nvbuf-memory-type=0</span><br><span class="line"></span><br><span class="line">[streammux]</span><br><span class="line">gpu-id=0</span><br><span class="line">##Boolean property to inform muxer that sources are live</span><br><span class="line">live-source=0</span><br><span class="line">batch-size=1</span><br><span class="line">##time out in usec, to wait after the first buffer is available</span><br><span class="line">##to push the batch even if the complete batch is not formed</span><br><span class="line">batched-push-timeout=40000</span><br><span class="line">## Set muxer output width and height</span><br><span class="line">width=1920</span><br><span class="line">height=1080</span><br><span class="line">##Enable to maintain aspect ratio wrt source, and allow black borders, works</span><br><span class="line">##along with width, height properties</span><br><span class="line">enable-padding=0</span><br><span class="line">nvbuf-memory-type=0</span><br><span class="line"></span><br><span class="line"># config-file property is mandatory for any gie section.</span><br><span class="line"># Other properties are optional and if set will override the properties set in</span><br><span class="line"># the infer config file.</span><br><span class="line">[primary-gie]</span><br><span class="line">enable=1</span><br><span class="line">gpu-id=0</span><br><span class="line">#model-engine-file=model_b1_gpu0_int8.engine</span><br><span class="line"># ä¿®æ”¹æ ‡ç­¾æ–‡ä»¶</span><br><span class="line">labelfile-path=helmet_names.txt</span><br><span class="line">batch-size=1</span><br><span class="line">#Required by the app for OSD, not a plugin property</span><br><span class="line">bbox-border-color0=1;0;0;1</span><br><span class="line">bbox-border-color1=0;1;1;1</span><br><span class="line">bbox-border-color2=0;0;1;1</span><br><span class="line">bbox-border-color3=0;1;0;1</span><br><span class="line">interval=2</span><br><span class="line">gie-unique-id=1</span><br><span class="line">nvbuf-memory-type=0</span><br><span class="line"># ä¿®æ”¹configæ–‡ä»¶</span><br><span class="line">config-file=config_infer_helmet_yoloV3.txt</span><br><span class="line"></span><br><span class="line">[tracker]</span><br><span class="line">enable=1</span><br><span class="line">tracker-width=640</span><br><span class="line">tracker-height=384</span><br><span class="line">ll-lib-file=/opt/nvidia/deepstream/deepstream-5.0/lib/libnvds_mot_klt.so</span><br><span class="line"></span><br><span class="line">[tests]</span><br><span class="line">file-loop=0</span><br></pre></td></tr></table></figure><p>å¦‚æœè¦æ£€æµ‹å¤šä¸ªè§†é¢‘ï¼Œåªè¦åœ¨<code>deepstream_app_config_yoloV3.txt</code>æ–‡ä»¶ä¸­æ·»åŠ <code>source</code>å’Œ<code>sink</code>å¹¶ä¸”ä¸€ä¸€å¯¹åº”å³å¯ã€‚</p><h3 id="æ£€æµ‹ç»“æœ"><a href="#æ£€æµ‹ç»“æœ" class="headerlink" title="æ£€æµ‹ç»“æœ"></a>æ£€æµ‹ç»“æœ</h3><p>å®‰å…¨å¸½æ£€æµ‹</p><p><img src="/2021/07/10/week-2-2/2-3.png" alt="18"></p><p>ä½¿ç”¨å®‰å…¨å¸½æ£€æµ‹æ¨¡å‹åŒæ—¶æ£€æµ‹2ä¸ªè§†é¢‘æ–‡ä»¶</p><p><img src="/2021/07/10/week-2-2/2-4.png" alt="18"></p><p>ç¬¬ä¸€æ¬¡è¿è¡Œç”Ÿæˆ<code>engine</code>ï¼Œè¿™æ˜¯æœ€è€—æ—¶çš„åœ°æ–¹ï¼Œ<code>engine</code>åªåœ¨ç¬¬ä¸€æ¬¡è¿è¡Œç”Ÿæˆï¼Œç„¶åå¯ä»¥æŠŠ<code>config_infer_primary_yoloV3.txt</code>æ–‡ä»¶ä¸­é…ç½®æ‰“å¼€ï¼Œå¤šæ¬¡è¿è¡Œæ—¶ä¸å¿…å†ç”Ÿæˆ<code>engine</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># å½“è¿™é¡¹é…ç½®æ‰“å¼€æ—¶ï¼Œè¿™æ ·åªä¼šåœ¨ç¬¬ä¸€æ¬¡ç”Ÿæˆå¼•æ“ï¼Œåç»­å¯åŠ¨ä¼šå¾ˆå¿«ã€‚</span><br><span class="line">model-engine-file=yolov3_b1_gpu0_int8.engine</span><br></pre></td></tr></table></figure><h2 id="æµ‹è¯•æ—¶é—´"><a href="#æµ‹è¯•æ—¶é—´" class="headerlink" title="æµ‹è¯•æ—¶é—´"></a>æµ‹è¯•æ—¶é—´</h2><p>æµ‹è¯•å®‰å…¨å¸½æ£€æµ‹ å‰å¤„ç†ï¼Œæ¨ç†ï¼Œåå¤„ç†æ‰€ç”¨çš„æ—¶é—´è¿™éƒ¨åˆ†è¿˜æ²¡æœ‰å®Œæˆã€‚ã€‚ã€‚</p><p>å°½é‡å°½å¿«è¡¥å……å®Œæˆï¼</p>]]></content>
    
    
    <summary type="html">Deepstream YoloV3æ£€æµ‹å®‰å…¨å¸½</summary>
    
    
    
    <category term="Internship" scheme="http://example.com/categories/Internship/"/>
    
    
    <category term="Jetson" scheme="http://example.com/tags/Jetson/"/>
    
    <category term="Deepstreeam" scheme="http://example.com/tags/Deepstreeam/"/>
    
  </entry>
  
  <entry>
    <title>Installing  GStreamer</title>
    <link href="http://example.com/2021/07/09/week-2-1/"/>
    <id>http://example.com/2021/07/09/week-2-1/</id>
    <published>2021-07-09T13:01:50.000Z</published>
    <updated>2021-07-11T06:48:49.708Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Installing-GStreamer"><a href="#Installing-GStreamer" class="headerlink" title="Installing  GStreamer"></a>Installing  GStreamer</h1><h2 id="Installing-on-Linux"><a href="#Installing-on-Linux" class="headerlink" title="Installing on Linux"></a>Installing on Linux</h2><p><strong>ç³»ç»Ÿï¼šUbuntu 16.04</strong></p><p>å‚ç…§<a href="https://gstreamer.freedesktop.org/documentation/installing/on-linux.html?gi-language=c">å®˜æ–¹æ–‡æ¡£</a>ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œä½†æ˜¯åœ¨æˆ‘çš„ç¬”è®°æœ¬å’Œå…¬å¸çš„å°å¼æœºä¸Šä¼¼ä¹ä¸å¤ªokâ€¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install libgstreamer1.0-dev libgstreamer-plugins-base1.0-dev libgstreamer-plugins-bad1.0-dev gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly gstreamer1.0-libav gstreamer1.0-doc gstreamer1.0-tools gstreamer1.0-x gstreamer1.0-alsa gstreamer1.0-gl gstreamer1.0-gtk3 gstreamer1.0-qt5 gstreamer1.0-pulseaudio</span><br></pre></td></tr></table></figure><p><a href="https://samwhelp.github.io/note-ubuntu-18.04/read/howto/install-tool/gstreamer/">å‚è€ƒ</a>äº†ä¸€ä½æ¹¾æ¹¾ç½‘å‹ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æˆåŠŸå®‰è£…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libgstreamer1.0-0 gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly gstreamer1.0-libav gstreamer1.0-doc gstreamer1.0-tools</span><br></pre></td></tr></table></figure><p><strong>Package</strong></p><ul><li><a href="https://packages.ubuntu.com/bionic/libgstreamer1.0-0">libgstreamer1.0-0</a></li><li><a href="https://packages.ubuntu.com/bionic/gstreamer1.0-plugins-base">gstreamer1.0-plugins-base</a></li><li><a href="https://packages.ubuntu.com/bionic/gstreamer1.0-plugins-good">gstreamer1.0-plugins-good</a></li><li><a href="https://packages.ubuntu.com/bionic/gstreamer1.0-plugins-bad">gstreamer1.0-plugins-bad</a></li><li><a href="https://packages.ubuntu.com/bionic/gstreamer1.0-plugins-ugly">gstreamer1.0-plugins-ugly</a></li><li><a href="https://packages.ubuntu.com/bionic/gstreamer1.0-libav">gstreamer1.0-libav</a></li><li><a href="https://packages.ubuntu.com/bionic/gstreamer1.0-doc">gstreamer1.0-doc</a></li><li><a href="https://packages.ubuntu.com/bionic/gstreamer1.0-tools">gstreamer1.0-tools</a></li></ul><p><strong>éªŒè¯å®‰è£…</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dpkg -l | grep gstreamer</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ GStreamer æ„å»ºåº”ç”¨ç¨‹åº</strong></p><p>ä¸ºäº†ç¼–è¯‘ GStreamer å¹¶ä½¿ç”¨ GStreamer æ ¸å¿ƒåº“çš„ä»£ç ï¼Œéœ€åœ¨<code>gcc</code>åæ·»åŠ ä»¥ä¸‹å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg-config --cflags --libs gstreamer-1.0</span><br></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨å…¶ä»– GStreamer åº“ï¼Œä¾‹å¦‚è§†é¢‘åº“ï¼Œåˆ™å¿…é¡»åœ¨ä¸Šè¿° gstreamer-1.0 ä¹‹åæ·»åŠ å…¶ä»–åŒ…ï¼ˆä¾‹å¦‚ï¼Œè§†é¢‘åº“çš„ gstreamer-video-1.0ï¼‰</p><p><strong>è·å–tutorialâ€™s source code</strong></p><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤gitåˆ°æœ¬åœ°ï¼Œå¯ä»¥åœ¨æ–‡ä»¶ç›®å½•<code>gst/examples/tutorials</code>ä¸­æ‰¾åˆ°ä¾‹ç¨‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://gitlab.freedesktop.org/gstreamer/gst-docs</span><br></pre></td></tr></table></figure><p><strong>Building the tutorials</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc basic-tutorial-1.c -o basic-tutorial-1 `pkg-config --cflags --libs gstreamer-1.0`</span><br></pre></td></tr></table></figure><p><strong>Running the tutorials</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./basic-tutorial-1</span><br></pre></td></tr></table></figure><p><strong>è¿è¡Œç»“æœ</strong></p><p><img src="/2021/07/09/week-2-1/2_1.png" alt="1"></p><p><strong>nice</strong>ï¼</p><h2 id="Installing-on-Windows"><a href="#Installing-on-Windows" class="headerlink" title="Installing on Windows"></a>Installing on Windows</h2><p>é¦–å…ˆå‚ç…§<a href="https://gstreamer.freedesktop.org/documentation/installing/on-windows.html?gi-language=c">å®˜æ–¹æ–‡æ¡£</a>å®‰è£…ï¼ŒçœŸçš„è›®å¿ƒç´¯çš„ï¼Œè‹±æ–‡æˆ‘éƒ½èƒ½çœ‹æ‡‚ï¼Œä½†å°±æ˜¯æä¸å®šã€‚è®°å½•ä¸€ä¸‹GStreamer on Windowsçš„å´å²–ä¹‹è·¯ã€‚</p><p><strong>ç¯å¢ƒï¼šWin 10 + VS2017</strong></p><p><strong>1. ä¸‹è½½GStreamer</strong></p><p>é€‰æ‹©MSVC 64-bit(æœ‰mingwå¯é€‰)</p><p><a href="https://gstreamer.freedesktop.org/data/pkg/windows/1.18.4/msvc/gstreamer-1.0-msvc-x86_64-1.18.4.msi">gstreamer-1.0-msvc-x86_64-1.18.4.msi</a>               å…ˆè£…</p><p><a href="https://gstreamer.freedesktop.org/data/pkg/windows/1.18.4/msvc/gstreamer-1.0-devel-msvc-x86_64-1.18.4.msi">gstreamer-1.0-devel-msvc-x86_64-1.18.4.msi</a>    åè£…</p><p>å®‰è£…çš„æ—¶å€™éƒ½é€‰æ‹©<code>Complete</code>å®Œæ•´å®‰è£…ï¼Œé»˜è®¤ä¼šå®‰è£…åœ¨å‰©ä½™ç©ºé—´æœ€å¤§çš„ç›˜ç¬¦</p><p><strong>2. é…ç½®ç³»ç»Ÿå˜é‡</strong></p><p>é¦–å…ˆå°†<code>glibconfig.h</code>æ–‡ä»¶æ‹·è´åˆ°<code>include/glib-2.0</code>ä»¥åŠ<code>include/glib-2.0/glib</code>ç›®å½•ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">|-- lib</span><br><span class="line">|   |-- glib-2.0</span><br><span class="line">|   |    -- include</span><br><span class="line">|   |        -- glibconfig.h æ­¤æ–‡ä»¶æ‹·è´åˆ°</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|-- include</span><br><span class="line">|     --glib-2.0 æ­¤ç›®å½•ä¸‹</span><br><span class="line">|        -- glib ä»¥åŠæ­¤ç›®å½•ä¸‹</span><br></pre></td></tr></table></figure><p>æ·»åŠ ç”¨æˆ·å˜é‡</p><p><img src="/2021/07/09/week-2-1/2_3.png" alt="3"></p><p>æ·»åŠ ç³»ç»Ÿå˜é‡</p><p><img src="/2021/07/09/week-2-1/2_4.png" alt="4"></p><p>Pathä¸­æ·»åŠ è·¯å¾„</p><p><img src="/2021/07/09/week-2-1/2_5.png" alt="5"></p><p><strong>3. ç¯å¢ƒæµ‹è¯•</strong></p><ul><li><p>å½±åƒæµ‹è¯•ï¼Œæ‰“å¼€cmdè¿è¡Œä»¥ä¸‹å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gst-launch-1.0 videotestsrc ! videoconvert ! autovideosink</span><br></pre></td></tr></table></figure></li></ul><p><img src="/2021/07/09/week-2-1/2_6.png" alt="6"></p><ul><li><p>æ’çƒæµ‹è¯•ï¼Œæ‰“å¼€cmdè¿è¡Œä»¥ä¸‹å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gst-launch-1.0 -v videotestsrc pattern=ball ! video/x-raw,width=320,height=240 ! videoconvert ! tee ! autovideosink device=0</span><br></pre></td></tr></table></figure><p><img src="/2021/07/09/week-2-1/2_7.png" alt="7"></p></li></ul><p>è‡³æ­¤ï¼ŒGStreamerçš„MSCVç¯å¢ƒokï¼Œæ¥ä¸‹æ¥åœ¨VS2017é…ç½®GStreamer</p><p><strong>4. VS2017é…ç½®GStreamer</strong></p><p>è¿˜æ˜¯ä¹‹å‰ä¸‹è½½çš„<a href="https://medium.com/r/?url=https://gitlab.freedesktop.org/gstreamer/gst-docs/">gst-docs</a>ï¼Œç”¨VSæ‰“å¼€ï¼ŒåŒå‡»<code>tutorials.sln</code></p><p><img src="/2021/07/09/week-2-1/2_8.png" alt="8"></p><p><code>tutorials</code>ç»™çš„æ˜¯<code>VS2010</code>çš„ä¾‹ç¨‹ï¼Œå½“ç„¶è¦å‡çº§ä¸€ä¸‹å•¦</p><p><img src="/2021/07/09/week-2-1/2_9.png" alt="9"></p><p>æ‰“å¼€åæ˜¯è¿™æ ·æ»´</p><p><img src="/2021/07/09/week-2-1/2_9_1.png" alt="9_1"></p><p>ç«™èµ·æ¥æ´»åŠ¨ä¸€ä¸‹ï¼Œç›´ç›´è…°å¯ä»¥å¼€å§‹å•¦ï¼Œä¸€ä¸Šæ¥å…¨æ˜¯<code>Errors</code>ï¼Œèƒ½è¿è¡Œæ‰å¥‡æ€ªæã€‚ã€‚ã€‚</p><p><img src="/2021/07/09/week-2-1/2_10.png" alt="10"></p><p>é‡ç‚¹æ¥äº†ï¼Œç¬¬ä¸€æ¬¡ç»™<code>VS2017</code>é…ç½®ç¬¬ä¸‰æ–¹åº“</p><p>â‘  è§£å†³æ–¹æ¡ˆèµ„æºç®¡ç†å™¨é‡Œé€‰æ‹©é¡¹ç›®åï¼Œå³é”®é¡¹ç›®ï¼Œé€‰æ‹©å±æ€§</p><p>åœ¨é…ç½®å±æ€§â€”â€”è°ƒè¯•â€”â€”å·¥ä½œç›®å½• å¢åŠ å¦‚ä¸‹ç›®å½•(é€‰æ‹©æ´»åŠ¨(x64)å¹³å°å“¦ï¼Œæ¥ä¸‹æ¥éƒ½æ˜¯)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\gstreamer\1.0\msvc_x86_64\bin</span><br></pre></td></tr></table></figure><p><img src="/2021/07/09/week-2-1/2_11.png" alt="11"></p><p>â‘¡åœ¨C/C++ â€”â€” å¸¸è§„â€”â€”é™„åŠ åŒ…å«ç›®å½• å¢åŠ å¦‚ä¸‹ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">D:\gstreamer\1.0\msvc_x86_64\include\gstreamer-1.0</span><br><span class="line">D:\gstreamer\1.0\msvc_x86_64\include\glib-2.0</span><br><span class="line">D:\gstreamer\1.0\msvc_x86_64\include\libxml2</span><br><span class="line">D:\gstreamer\1.0\msvc_x86_64\include</span><br><span class="line">D:\gstreamer\1.0\msvc_x86_64\lib\glib-2.0\include</span><br></pre></td></tr></table></figure><p><img src="/2021/07/09/week-2-1/2_12.png" alt="12"></p><p>â‘¢åœ¨é“¾æ¥å™¨â€”-å¸¸è§„â€”-é™„åŠ åº“ç›®å½•ï¼Œå¢åŠ  å¦‚ä¸‹ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\gstreamer\1.0\msvc_x86_64\lib</span><br></pre></td></tr></table></figure><p><img src="/2021/07/09/week-2-1/2_13.png" alt="13"></p><p>â‘£åœ¨é“¾æ¥å™¨â€”-è¾“å…¥â€”â€“é™„åŠ ä¾èµ–æ€§ å¢åŠ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gobject-2.0.lib</span><br><span class="line">glib-2.0.lib</span><br><span class="line">gstreamer-1.0.lib</span><br></pre></td></tr></table></figure><p><img src="/2021/07/09/week-2-1/2_14.png" alt="14"></p><p>æµ‹è¯•ä¸€ä¸‹ï¼Œè¿è¡Œä¸€ä¸‹<code>basic-tutorial-1.c</code>ï¼Œæ²¡æœ‰æŠ¥é”™äº†ï¼Œæ’’èŠ±<em>â˜…,Â°</em>:.â˜†(ï¿£â–½ï¿£)/$:<em>.Â°â˜…</em> </p><p><img src="/2021/07/09/week-2-1/2_15.png" alt="15"></p><p>è¿è¡Œç»“æœ</p><p><img src="/2021/07/09/week-2-1/2_17.png" alt="17"></p><p><code>basic-tutorial-1.c</code>çš„ä»£ç å°±å…ˆä¸è§£è¯»å•¦ï¼Œé‡Œé¢æ³¨é‡Šå¾ˆæ¸…æ™°äº†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;gst/gst.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span></span></span><br><span class="line"><span class="function"><span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">GstElement *pipeline;</span><br><span class="line">GstBus *bus;</span><br><span class="line">GstMessage *msg;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Initialize GStreamer */</span></span><br><span class="line">gst_init(&amp;argc, &amp;argv);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Build the pipeline */</span></span><br><span class="line">pipeline =</span><br><span class="line">gst_parse_launch</span><br><span class="line">(<span class="string">&quot;playbin uri=https://www.freedesktop.org/software/gstreamer-sdk/data/media/sintel_trailer-480p.webm&quot;</span>,</span><br><span class="line"><span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Start playing */</span></span><br><span class="line">gst_element_set_state(pipeline, GST_STATE_PLAYING);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Wait until error or EOS */</span></span><br><span class="line">bus = gst_element_get_bus(pipeline);</span><br><span class="line">msg =</span><br><span class="line">gst_bus_timed_pop_filtered(bus, GST_CLOCK_TIME_NONE,</span><br><span class="line">GST_MESSAGE_ERROR | GST_MESSAGE_EOS);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Free resources */</span></span><br><span class="line"><span class="keyword">if</span> (msg != <span class="literal">NULL</span>)</span><br><span class="line">gst_message_unref(msg);</span><br><span class="line">gst_object_unref(bus);</span><br><span class="line">gst_element_set_state(pipeline, GST_STATE_NULL);</span><br><span class="line">gst_object_unref(pipeline);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>GStreamer on Windowsçš„å®‰è£…è‡³æ­¤ç®—æ˜¯æå®šäº†ï¼Œè¿˜æ˜¯æœ‰èŠ±è›®å¤šç²¾åŠ›çš„ï¼No pains, no gains. æ¥ä¸‹æ¥è¿˜è¦å­¦å†™GStreameræ’ä»¶ï¼Œèƒ½å†™å¥½çš„å†è®°å½•ä¸€ä¸‹ï¼</p><p><strong>å‚è€ƒ</strong></p><p><a href="https://gstreamer.freedesktop.org/data/pkg/windows/1.18.4/msvc/">https://gstreamer.freedesktop.org/data/pkg/windows/1.18.4/msvc/</a></p><p><a href="https://gstreamer.freedesktop.org/documentation/installing/index.html?gi-language=c">https://gstreamer.freedesktop.org/documentation/installing/index.html?gi-language=c</a></p><p><a href="https://www.cnblogs.com/0-lingdu/p/12718613.html">https://www.cnblogs.com/0-lingdu/p/12718613.html</a></p><p><a href="https://blog.csdn.net/kongxingxing/article/details/104270463">https://blog.csdn.net/kongxingxing/article/details/104270463</a></p><p><a href="https://blog.csdn.net/fly_bear_unknown/article/details/113917633">https://blog.csdn.net/fly_bear_unknown/article/details/113917633</a></p>]]></content>
    
    
    <summary type="html">GStreameråœ¨Ubuntuå’ŒWindowsä¸Šå®‰è£…</summary>
    
    
    
    <category term="Internship" scheme="http://example.com/categories/Internship/"/>
    
    
    <category term="GStreamer" scheme="http://example.com/tags/GStreamer/"/>
    
  </entry>
  
  <entry>
    <title>Jetson éƒ¨ç½² Deepstream</title>
    <link href="http://example.com/2021/07/02/week-1/"/>
    <id>http://example.com/2021/07/02/week-1/</id>
    <published>2021-07-02T12:13:16.000Z</published>
    <updated>2021-07-14T13:10:10.498Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Jetson-éƒ¨ç½²-Deep-stream"><a href="#Jetson-éƒ¨ç½²-Deep-stream" class="headerlink" title="Jetson éƒ¨ç½² Deep stream"></a>Jetson éƒ¨ç½² Deep stream</h1><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><h3 id="æŸ¥çœ‹Jetsonä¿¡æ¯"><a href="#æŸ¥çœ‹Jetsonä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹Jetsonä¿¡æ¯"></a><strong>æŸ¥çœ‹Jetsonä¿¡æ¯</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> sudo pip3 install jetson-stats</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> jtop</span></span><br></pre></td></tr></table></figure><p><img src="/2021/07/02/week-1/01.png" alt="01"></p><h3 id="Jetson-Setup"><a href="#Jetson-Setup" class="headerlink" title="Jetson Setup"></a><strong>Jetson Setup</strong></h3><p>å¦‚æœæ˜¯ Jetson Nano æˆ–è€… Jetson Xavier NX developer kit, ä»<a href="https://developer.nvidia.com/embedded/jetpack">JetPack SDK</a>ä¸‹è½½ SD card imageï¼Œè¿™å…¶ä¸­åŒ…å«äº† CUDA, TensorRT and cuDNN.</p><h3 id="å‘½ä»¤è¡Œå·¥å…·nvpmodel"><a href="#å‘½ä»¤è¡Œå·¥å…·nvpmodel" class="headerlink" title="å‘½ä»¤è¡Œå·¥å…·nvpmodel"></a><strong>å‘½ä»¤è¡Œå·¥å…·nvpmodel</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo nvpmodel --query</span></span><br><span class="line">NV Fan Mode:cool</span><br><span class="line">NV Power Mode: MODE_15W_2CORE</span><br><span class="line">0</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ‡æ¢åˆ°æ¨¡å¼2</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo nvpmodel -m 2</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æœ€å¤§åŒ–Xavieræ€§èƒ½</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo jetson_clocks</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ˜¾ç¤ºå½“å‰è®¾ç½®ï¼š</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo jetson_clocks --show</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ¢å¤ä»¥å‰çš„è®¾ç½®</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo jetson_clocks --restore</span></span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹æ“ä½œç³»ç»Ÿä¿¡æ¯"><a href="#æŸ¥çœ‹æ“ä½œç³»ç»Ÿä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹æ“ä½œç³»ç»Ÿä¿¡æ¯"></a><strong>æŸ¥çœ‹æ“ä½œç³»ç»Ÿä¿¡æ¯</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> LinuxæŸ¥çœ‹ç‰ˆæœ¬å½“å‰æ“ä½œç³»ç»Ÿ å†…æ ¸ä¿¡æ¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> uname --a</span></span><br><span class="line">Linux name-desktop 4.9.140-tegra #1 SMP PREEMPT Thu Jun 25 21:22:12 PDT 2020 aarch64 aarch64 aarch64 GNU/Linux</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> LinuxæŸ¥çœ‹å½“å‰æ“ä½œç³»ç»Ÿ ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> cat /proc/version</span></span><br><span class="line">Linux version 4.9.140-tegra (buildbrain@mobile-u64-3357) (gcc version 7.3.1 20180425 [linaro-7.3-2018.05 revision d29120a424ecfbc167ef90065c0eeb7f91977701] (Linaro GCC 7.3-2018.05) ) #1 SMP PREEMPT Thu Jun 25 21:22:12 PDT 2020</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> LinuxæŸ¥çœ‹ç‰ˆæœ¬å½“å‰æ“ä½œç³»ç»Ÿ å‘è¡Œç‰ˆä¿¡æ¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> cat /etc/issue</span></span><br><span class="line">Ubuntu 18.04.5 LTS \n \l</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹cpuçš„ä¿¡æ¯</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> cat /proc/cpuinfo</span></span><br><span class="line">processor: 0</span><br><span class="line">model name: ARMv8 Processor rev 0 (v8l)</span><br><span class="line">BogoMIPS: 62.50</span><br><span class="line">Features: fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp</span><br><span class="line">CPU implementer: 0x4e</span><br><span class="line">CPU architecture: 8</span><br><span class="line">CPU variant: 0x0</span><br><span class="line">CPU part: 0x004</span><br><span class="line">CPU revision: 0</span><br><span class="line">MTS version: 50168445</span><br><span class="line">â€¦</span><br><span class="line">â€¦</span><br><span class="line">â€¦</span><br><span class="line">processor: 5</span><br><span class="line">model name: ARMv8 Processor rev 0 (v8l)</span><br><span class="line">BogoMIPS: 62.50</span><br><span class="line">Features: fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp</span><br><span class="line">CPU implementer: 0x4e</span><br><span class="line">CPU architecture: 8</span><br><span class="line">CPU variant: 0x0</span><br><span class="line">CPU part: 0x004</span><br><span class="line">CPU revision: 0</span><br><span class="line">MTS version: 50168445</span><br></pre></td></tr></table></figure><h3 id="DeepStream-Setup"><a href="#DeepStream-Setup" class="headerlink" title="DeepStream Setup"></a>DeepStream Setup</h3><ol><li><p><a href="https://developer.nvidia.com/deepstream-sdk">NVIDIA DeepStream SDK</a>å®˜ç½‘ä¸‹è½½ <code>deepstream_sdk_v5.0.1_jetson.tbz2</code></p></li><li><p>å‘½ä»¤è¡Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo tar -xvf deepstream_sdk_v5.0.1_jetson.tbz2 -C /</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> /opt/nvidia/deepstream/deepstream-5.0</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo ./install.sh</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo ldconfig</span></span><br></pre></td></tr></table></figure></li></ol><p><img src="/2021/07/02/week-1/02.png" alt="02"></p><h3 id="Run-deepstream-app"><a href="#Run-deepstream-app" class="headerlink" title="Run deepstream-app"></a>Run deepstream-app</h3><ol><li><p>å¯¼èˆªåˆ°ç¤ºä¾‹ç›®å½•(samples)ã€‚</p></li><li><p>è¾“å…¥ä»¥ä¸‹å‘½ä»¤ä»¥è¿è¡Œå‚è€ƒåº”ç”¨ç¨‹åºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> deepstream-app -c &lt;path_to_config_file&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;path_to_config_file&gt;</code>å¯ä»¥åœ¨<code>configs/deepstream-app/</code>ä¸­æ‰¾åˆ°</p></li><li><p>åœ¨æºæ–‡ä»¶ç›®å½•ä¸­æ‰¾åˆ°æºç ï¼Œç¼–è¯‘å¹¶è¿è¡Œdemo</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æºæ–‡ä»¶ç›®å½•ï¼ˆdeepstream-test1ï¼‰</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> éƒ½éœ€è¦makeç¼–è¯‘ï¼Œå…·ä½“è¯·å‚é˜…å…¶ä¸­çš„READMEæ–‡æ¡£</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> /opt/nvidia/deepstream/deepstream-5.0/sources/apps/sample_apps/deepstream-test1</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls</span></span><br><span class="line">deepstream_test1_app.c  dstest1_pgie_config.txt  Makefile  README</span><br><span class="line"><span class="meta">$</span><span class="bash"> make</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls</span></span><br><span class="line">deepstream-test1-app    deepstream_test1_app.o   Makefile</span><br><span class="line">deepstream_test1_app.c  dstest1_pgie_config.txt  README</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¿è¡Œdeepstream-test1-app</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ./deepstream-test1-app /opt/nvidia/deepstream/deepstream-5.0/samples/streams/sample_720p.h264</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">Reference test application</th><th align="center">Path inside sources directory</th><th>Description</th></tr></thead><tbody><tr><td align="center">Sample test application 1</td><td align="center">apps/sample_apps/deepstream-test1</td><td>Sample of how to use DeepStream elements for a single H.264 stream: filesrc â†’ decode â†’ nvstreammuH264 containerized streamx â†’ nvinfer (primary detector) â†’ nvdsosd â†’ renderer.</td></tr><tr><td align="center">Sample test application 2</td><td align="center">apps/sample_apps/deepstream-test2</td><td>Sample of how to use DeepStream elements for a single H.264 stream: filesrc â†’ decode â†’ nvstreammux â†’ nvinfer (primary detector) â†’ nvtracker â†’ nvinfer (secondary classifier) â†’ nvdsosd â†’ renderer.</td></tr><tr><td align="center">Sample test application 3</td><td align="center">apps/sample_apps/deepstream-test3</td><td>Builds on deepstream-test1 (simple test application 1) to demonstrate how to:Use multiple sources in the pipelineUse a uridecodebin to accept any type of input (e.g. RTSP/File), any GStreamer supported container format, and any codecConfigure Gst-nvstreammux to generate a batch of frames and infer on it for better resource utilizationExtract the stream metadata, which contains useful information about the frames in the batched buffer</td></tr><tr><td align="center">Sample test application 4</td><td align="center">apps/sample_apps/deepstream-test4</td><td>Builds on deepstream-test1 for a single H.264 stream: filesrc, decode, nvstreammux, nvinfer, nvdsosd, renderer to demonstrate how to:Use the Gst-nvmsgconv and Gst-nvmsgbroker plugins in the pipelineCreate NVDS_META_EVENT_MSG type metadata and attach it to the bufferUse NVDS_META_EVENT_MSG for different types of objects, e.g. vehicle and personImplement â€œcopyâ€ and â€œfreeâ€ functions for use if metadata is extended through the extMsg field</td></tr><tr><td align="center">Sample test application 5</td><td align="center">apps/sample_apps/deepstream-test5</td><td>Builds on top of deepstream-app. Demonstrates:Use of Gst-nvmsgconv and Gst-nvmsgbroker plugins in the pipeline for multistreamHow to configure Gst-nvmsgbroker plugin from the config file as a sink plugin (for KAFKA, Azure, etc.)How to handle the RTCP sender reports from RTSP servers or cameras and translate the Gst Buffer PTS to a UTC timestamp.For more details refer the RTCP Sender Report callback function <code>test5_rtcp_sender_report_callback()</code> registration and usage in <code>deepstream_test5_app_main.c</code>. GStreamer callback registration with rtpmanager elementâ€™s â€œhandle-syncâ€ signal is documented in <code>apps-common/src/deepstream_source_bin.c</code>.</td></tr></tbody></table></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">|-- opt</span><br><span class="line">    |-- nvidia</span><br><span class="line">        |-- deepstream</span><br><span class="line">            |-- deepstream</span><br><span class="line">            |-- deepstream-5.0</span><br><span class="line">                |-- bin</span><br><span class="line">                |-- doc</span><br><span class="line">                |-- lib</span><br><span class="line">                |-- samples</span><br><span class="line">                |   |-- configs</span><br><span class="line">                |   |   |-- deepstream-app</span><br><span class="line">                |   |   |   |-- config_infer_primary.txt#å°†nvinferé…ç½®ä¸ºä¸»è¦æ£€æµ‹å™¨</span><br><span class="line">                |   |   |   |-- config_infer_primary_nano.txt</span><br><span class="line">                |   |   |   |-- config_infer_secondary_carcolor.txt#å°†nvinferé…ç½®ä¸ºè¾…åŠ©åˆ†ç±»å™¨</span><br><span class="line">                |   |   |   |-- config_infer_secondary_carmake.txt</span><br><span class="line">                |   |   |   |-- config_infer_secondary_vehicletypes.txt</span><br><span class="line">                |   |   |   |-- iou_config.txt#é…ç½®ä¸€ä¸ªä½çº§çš„IOUè·Ÿè¸ªå™¨ã€‚</span><br><span class="line">                |   |   |   |-- source12_1080p_dec_infer-resnet_tracker_tiled_display_fp16_tx2.txt</span><br><span class="line">                |   |   |   |-- source1_csi_dec_infer_resnet_int8.txt   #æ¼”ç¤ºä¸€ä¸ªCSIæ‘„åƒæœºä½œä¸ºè¾“å…¥ï¼›ä»…é€‚ç”¨äºJetson</span><br><span class="line">                |   |   |   |-- source1_usb_dec_infer_resnet_int8.txt#æ¼”ç¤ºä¸€ä¸ªUSBæ‘„åƒæœºä½œä¸ºè¾“å…¥</span><br><span class="line">                |   |   |   |-- source2_csi_usb_dec_infer_resnet_int8.txt</span><br><span class="line">                                #æ¼”ç¤º30ä¸ªå…·æœ‰ä¸»è¦æ¨ç†åŠŸèƒ½çš„æµè§£ç ï¼ˆä»…é€‚ç”¨äºdGPUå’ŒJetson AGX Xavierå¹³å°ï¼‰</span><br><span class="line">                |   |   |   |-- source30_1080p_dec_infer-resnet_tiled_display_int8.txt </span><br><span class="line">                #æ¼”ç¤ºå…·æœ‰ä¸»è¦æ¨ç†ï¼Œå¯¹è±¡è·Ÿè¸ªå’Œä¸‰ä¸ªä¸åŒè¾…åŠ©åˆ†ç±»å™¨çš„å››ä¸ªæµè§£ç ï¼ˆä»…é€‚ç”¨äºdGPUå’ŒJetson AGX Xavierå¹³å°ï¼‰</span><br><span class="line">                |   |   |   |-- source4_1080p_dec_infer-resnet_tracker_sgie_tiled_display_int8.txt</span><br><span class="line">                |   |   |   |-- source6_csi_dec_infer_resnet_int8.txt</span><br><span class="line">                |   |   |   |-- source8_1080p_dec_infer-resnet_tracker_tiled_display_fp16_nano.txt</span><br><span class="line">                |   |   |   |-- source8_1080p_dec_infer-resnet_tracker_tiled_display_fp16_tx1.txt</span><br><span class="line">                |   |   |   |-- tracker_config.yml#é…ç½®NvDCFè·Ÿè¸ªå™¨</span><br><span class="line">                |   |   |-- deepstream-app-trtis</span><br><span class="line">                |   |   |-- tlt_pretrained_models</span><br><span class="line">                |   |-- models</span><br><span class="line">                |   |-- streams</span><br><span class="line">                |   |   |-- sample_1080p_h264.mp4#H264 containerized stream</span><br><span class="line">                |   |   |-- sample_1080p_h265.mp4#H265 containerized stream</span><br><span class="line">                |   |   |-- sample_720p.h264#H264 elementary stream</span><br><span class="line">                |   |   |-- sample_720p.jpg#JPEG image</span><br><span class="line">                |   |   |-- sample_720p.mjpeg#MJPEG stream</span><br><span class="line">                |   |   |-- sample_720p.mp4</span><br><span class="line">                |   |   |-- sample_cam6.mp4#H264 containerized stream(360D camera stream)</span><br><span class="line">                |   |   |-- sample_industrial.jpg</span><br><span class="line">                |   |   |-- sample_qHD.h264</span><br><span class="line">                |   |   |-- sample_qHD.mp4</span><br><span class="line">                |   |   |-- yoga.jpg</span><br><span class="line">                |   |   |-- yoga.mp4</span><br><span class="line">                |   |-- trtis_model_repo</span><br><span class="line">                |-- sources</span><br><span class="line">                    |-- apps</span><br><span class="line">                    |   |-- apps-common</span><br><span class="line">                    |   |   |-- includes</span><br><span class="line">                    |   |-- sample_apps</span><br><span class="line">                    |       |-- deepstream-app#ç«¯åˆ°ç«¯ç¤ºä¾‹æ¼”ç¤ºäº†4çº§è”ç¥ç»ç½‘ç»œ(1ä¸ªä¸€çº§æ£€æµ‹å™¨å’Œ3ä¸ªäºŒçº§åˆ†ç±»å™¨)çš„å¤šç›¸æœºæµï¼Œå¹¶æ˜¾ç¤ºå¹³é“ºè¾“å‡ºã€‚</span><br><span class="line">                    |       |   |-- Makefile</span><br><span class="line">                    |       |   |-- README</span><br><span class="line">                    |       |   |-- deepstream_app.c</span><br><span class="line">                    |       |   |-- deepstream_app.h</span><br><span class="line">                    |       |   |-- deepstream_app_config_parser.c</span><br><span class="line">                    |       |   |-- deepstream_app_main.c</span><br><span class="line">                    |       |-- deepstream-test1#å¯¹å•ä¸€H264è§†é¢‘æµï¼Œåº”ç”¨filesrcâ†’decodeâ†’nvstreammuH264 containerized streamxâ†’nvinfer(ä¸»æ£€æµ‹å™¨)â†’nvdsosdâ†’renderer</span><br><span class="line">                    |       |   |-- Makefile</span><br><span class="line">                    |       |   |-- README</span><br><span class="line">                 Builds on deepstream-test1 (simple test application 1) to demonstrate how to:Use multiple sources in the pipelineUse a uridecodebin to accept any type of input (e.g. RTSP/File), any GStreamer supported container format, and any codecConfigure Gst-nvstreammux to generate a batch of frames and infer on it for better resource utilizationExtract the stream metadata, which contains useful information about the frames in the batched buffer   |       |   |-- deepstream-test1-app</span><br><span class="line">                    |       |   |-- deepstream_test1_app.c</span><br><span class="line">                    |       |   |-- deepstream_test1_app.o</span><br><span class="line">                    |       |   |-- dstest1_pgie_config.txt</span><br><span class="line">                    |       |-- deepstream-test2#å»ºç«‹åœ¨test1ä¹‹ä¸Šï¼Œæ˜¾ç¤ºé¢å¤–çš„å±æ€§ï¼Œå¦‚è·Ÿè¸ªå’ŒäºŒçº§åˆ†ç±»å±æ€§ã€‚</span><br><span class="line">                    |       |   |-- Makefile</span><br><span class="line">                    |       |   |-- README</span><br><span class="line">                    |       |   |-- deepstream_test2_app.c</span><br><span class="line">                    |       |   |-- dstest2_pgie_config.txt</span><br><span class="line">                    |       |   |-- dstest2_sgie1_config.txt</span><br><span class="line">                    |       |   |-- dstest2_sgie2_config.txt</span><br><span class="line">                    |       |   |-- dstest2_sgie3_config.txt</span><br><span class="line">                    |       |   |-- dstest2_tracker_config.txt</span><br><span class="line">                    |       |   |-- tracker_config.yml</span><br><span class="line">                    |       |-- deepstream-test3#å»ºç«‹åœ¨test1çš„åŸºç¡€ä¸Šï¼Œæ˜¾ç¤ºå¤šä¸ªè¾“å…¥æºå’Œæ‰¹å¤„ç†ä½¿ç”¨nvstreammuxerã€‚</span><br><span class="line">                    |       |   |-- Makefile</span><br><span class="line">                    |       |   |-- README</span><br><span class="line">                    |       |   |-- deepstream_test3_app.c</span><br><span class="line">                    |       |   |-- dstest3_pgie_config.txt</span><br><span class="line">                    |       |-nfer_primary.txt</span><br><span class="line">                |   |   |   |-- config_infer_primary_nano.txt</span><br><span class="line">                |   |   |   |-- config_infer_secondary_carcolor.txt</span><br><span class="line">                |   |   |   |-- config_infer_secondary_carmake.txt</span><br><span class="line">                |   |   |   |-- config_infer_secondary_vehicletypes.txt</span><br><span class="line">                |   |   |   |-- iou_config.txt</span><br><span class="line">                |   |   |   |-- source12_1080p_dec_infer-resnet_tracker_tiled_display_fp16_tx2.txt</span><br><span class="line">                |   |   |   |-- source1_csi_dec_infer_resnet_int8.txt</span><br><span class="line">                |   |   |   |-- source1_usb_dec_infer_resnet_int8.txt</span><br><span class="line">                |   |   |   |-- source2_cs- deepstream-test4</span><br><span class="line">                    |       |   |-- Makefile</span><br><span class="line">                    |       |   |-- README</span><br><span class="line">                    |       |   |-- cfg_amqp.txt</span><br><span class="line">                    |       |   |-- cfg_azure.txt</span><br><span class="line">                    |       |   |-- cfg_kafka.txt</span><br><span class="line">                    |       |   |-- deepstream_test4_app.c</span><br><span class="line">                    |       |   |-- dstest4_msgconv_config.txt</span><br><span class="line">                    |       |   |-- dstest4_pgie_config.txt</span><br><span class="line">                    |       |-- deepstream-test5</span><br><span class="line">                    |       |   |-- Makefile</span><br><span class="line">                    |       |   |-- README</span><br><span class="line">                    |       |   |-- deepstream_test5_app.h</span><br><span class="line">                    |       |   |-- deepstream_test5_app_main.c</span><br><span class="line">                    |       |   |-- deepstream_utc.c</span><br><span class="line">                    |       |   |-- configs</span><br><span class="line">                    |       |       |-- dstest5_msgconv_sample_config.txt</span><br><span class="line">                    |       |       |-- test5_config_file_src_infer.txt</span><br><span class="line">                    |       |       |-- test5_config_file_src_infer_azure_iotedge.txt</span><br><span class="line">                    |       |       |-- test5_config_file_src_infer_tiler_demux.txt</span><br><span class="line">                    |       |       |-- test5_config_file_src_infer_tracker_sgie.txt</span><br><span class="line">                    |       |       |-- test5_dec_infer-resnet_tracker_sgie_tiled_display_int8.txt</span><br><span class="line">                    |       |       |-- test5_ota_override_config.txt</span><br><span class="line">                    |-- gst-plugins</span><br><span class="line">                    |-- includes</span><br><span class="line">                    |-- libs</span><br><span class="line">                    |-- objectDetector_FasterRCNN</span><br><span class="line">                    |-- objectDetector_SSD</span><br><span class="line">                    |-- objectDetector_Yolo</span><br><span class="line">                    |-- tools</span><br></pre></td></tr></table></figure><p>æ—¥å¿—ä¿¡æ¯ï¼š</p><p><img src="/2021/07/02/week-1/04.png" alt="04"><br>ç»“æœæ˜¾ç¤ºï¼š</p><p><img src="/2021/07/02/week-1/05.png" alt="05"></p><p><img src="/2021/07/02/week-1/08.png" alt="08"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://docs.nvidia.com/metropolis/deepstream/dev-guide/index.html">NVIDIA DeepStream SDKå¼€å‘æŒ‡å—</a></p><p><a href="https://docs.nvidia.com/metropolis/deepstream/plugin-manual/index.html">NVIDIA DeepStreamæ’ä»¶æ‰‹å†Œ</a></p><p><a href="https://docs.nvidia.com/metropolis/deepstream/dev-guide/">NVIDIA DeepStream SDK APIå‚è€ƒæ–‡æ¡£</a></p>]]></content>
    
    
    <summary type="html">Jetson Xavier NXéƒ¨ç½² Deepstream</summary>
    
    
    
    <category term="Internship" scheme="http://example.com/categories/Internship/"/>
    
    
    <category term="Jetson" scheme="http://example.com/tags/Jetson/"/>
    
    <category term="Deepstreeam" scheme="http://example.com/tags/Deepstreeam/"/>
    
  </entry>
  
  <entry>
    <title>CMake&amp;Meson è¾¹å­¦è¾¹è®°</title>
    <link href="http://example.com/2021/04/10/cmake-notes/"/>
    <id>http://example.com/2021/04/10/cmake-notes/</id>
    <published>2021-04-10T12:32:42.000Z</published>
    <updated>2021-07-22T11:55:09.726Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CMakeç¬”è®°"><a href="#CMakeç¬”è®°" class="headerlink" title="CMakeç¬”è®°"></a>CMakeç¬”è®°</h1><p><strong>ä¸€å¼€å§‹æ˜¯è®°å½•CMakeçš„å­¦ä¹ ï¼Œ7æœˆä»½å®ä¹ ç”¨åˆ°äº†Mesonï¼Œæ•…ä¹Ÿè®°å½•åœ¨äº†è¿™ç¯‡æ–‡ç« ä¸­ã€‚</strong></p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="Windowså®‰è£…"><a href="#Windowså®‰è£…" class="headerlink" title="Windowså®‰è£…"></a>Windowså®‰è£…</h3><ul><li>ç½‘å€ï¼š<a href="https://cmake.org/download/">https://cmake.org/download/</a></li></ul><h3 id="Linuxå®‰è£…"><a href="#Linuxå®‰è£…" class="headerlink" title="Linuxå®‰è£…"></a>Linuxå®‰è£…</h3><ul><li><p>ç›´æ¥å®‰è£… <code>apt install cmake</code></p></li><li><p>ç½‘å€ï¼š<a href="https://cmake.org/download/">https://cmake.org/download/</a>     ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„CMakeï¼ˆ32ä½æˆ–è€…64ä½ï¼‰</p></li><li><p>è¾“å…¥ä»¥ä¸‹å‘½ä»¤è¿›è¡Œè§£å‹</p><p><code>    tar -zxvf cmake-3.10.0-rc4-Linux-x86_64.tar.gz</code></p></li><li><p>æŠŠè§£å‹åçš„ç›®å½•æ”¹åä¸ºï¼šcmake</p><p><code>mv cmake-3.10.0-rc4-Linux-x86_64 cmake</code></p></li><li><p>å®‰è£…å®Œæ¯•ï¼Œå‘½ä»¤è¡Œè¾“å…¥ï¼š<code>cmake --version</code>æ£€æµ‹æ˜¯å¦å®‰è£…æˆåŠŸ</p></li></ul><h2 id="CMakeåˆæ¢"><a href="#CMakeåˆæ¢" class="headerlink" title="CMakeåˆæ¢"></a>CMakeåˆæ¢</h2><p><strong>åŸºæœ¬éƒ½åœ¨æˆ‘çš„é˜¿é‡Œäº‘æœåŠ¡å™¨ä¸Šå€’è…¾ï¼Œç¯å¢ƒä¸ºUbuntu 16.04</strong></p><h3 id="CMakeåŸºç¡€çŸ¥è¯†"><a href="#CMakeåŸºç¡€çŸ¥è¯†" class="headerlink" title="CMakeåŸºç¡€çŸ¥è¯†"></a>CMakeåŸºç¡€çŸ¥è¯†</h3><ul><li><p>æœ€ä½ç‰ˆæœ¬</p><ul><li><p><code>CMakeLists.txt</code>çš„ç¬¬ä¸€è¡Œéƒ½ä¼šå†™ï¼š<code>cmake_minimum_required(VERSION 3.1)</code>ï¼Œè¯¥å‘½ä»¤æŒ‡å®šäº†CMakeçš„æœ€ä½ç‰ˆæœ¬æ˜¯3.1</p></li><li><p>å‘½ä»¤åç§°<code>cmake_minimum_required</code>ä¸åŒºåˆ†å¤§å°å†™</p></li><li><p>è®¾ç½®ç‰ˆæœ¬èŒƒå›´ï¼š<code>cmake_minimum_required(VERSION 3.1...3.12)</code></p></li><li><p>åˆ¤æ–­CMakeç‰ˆæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#è¯¥å‘½ä»¤è¡¨ç¤ºï¼šå¦‚æœCMakeç‰ˆæœ¬å°äº3.12ï¼Œåˆ™ifå—å°†ä¸ºtrueï¼Œç„¶åå°†è®¾ç½®ä¸ºå½“å‰CMakeç‰ˆæœ¬</span><br><span class="line">#å¦‚æœCMakeç‰ˆæœ¬é«˜äº3.12ï¼Œifå—ä¸ºå‡ï¼Œcmake_minimum_requiredå°†è¢«æ­£ç¡®æ‰§è¡Œ</span><br><span class="line">if($&#123;CMAKE_VERSION&#125; VERSION_LESS 3.12)     </span><br><span class="line">    cmake_policy(VERSION $&#123;CMAKE_MAJOR_VERSION&#125;.$&#123;CMAKE_MINOR_VERSION&#125;) </span><br><span class="line">endif() </span><br></pre></td></tr></table></figure></li><li><p>æ³¨æ„ï¼šå¦‚æœéœ€è¦æ”¯æŒéå‘½ä»¤è¡ŒWindowsç‰ˆæœ¬åˆ™éœ€åœ¨ä¸Šé¢çš„ifåˆ¤æ–­åŠ ä¸Šelseåˆ†æ”¯ï¼Œå¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 3.1)</span><br><span class="line">if($&#123;CMAKE_VERSION&#125; VERSION_LESS 3.12)</span><br><span class="line">    cmake_policy(VERSION $&#123;CMAKE_MAJOR_VERSION&#125;.$&#123;CMAKE_MINOR_VERSION&#125;)</span><br><span class="line">else()</span><br><span class="line">    cmake_policy(VERSION 3.12)</span><br><span class="line">endif()</span><br></pre></td></tr></table></figure></li></ul></li><li><p>è®¾ç½®ç”Ÿæˆé¡¹ç›®åç§°</p><ul><li><p>å‘½ä»¤ï¼š<code>projectï¼ˆMyProjectï¼‰</code>,è¡¨ç¤ºç”Ÿæˆçš„å·¥ç¨‹åå­—å«åšï¼š<code>MyProject</code></p></li><li><p>å‘½ä»¤è¿˜å¯ä»¥æ ‡è¯†é¡¹ç›®æ”¯æŒçš„è¯­è¨€ï¼Œå†™æ³•ï¼š<code>projectï¼ˆMyProject[C] [C++]ï¼‰</code>,ä¸è¿‡é€šå¸¸å°†åé¢çš„å‚æ•°çœæ‰ï¼Œå› ä¸ºé»˜è®¤æ”¯æŒæ‰€æœ‰è¯­è¨€</p></li><li><p>ä½¿ç”¨è¯¥æŒ‡ä»¤ä¹‹åç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºä¸¤ä¸ªå˜é‡ï¼š<code>&lt;projectname&gt;_BINARY_DIR</code>  äºŒè¿›åˆ¶æ–‡ä»¶ä¿å­˜è·¯å¾„ã€<code>&lt;projectname&gt;_SOURCE_DIR</code>  æºä»£ç è·¯å¾„</p></li><li><p>æ‰§è¡Œ<code>project(MyProject)</code>ï¼Œå°±æ˜¯å®šä¹‰äº†ä¸€ä¸ªé¡¹ç›®çš„åç§°ä¸º<code>MyProject</code>ï¼Œå¯¹åº”çš„å°±ä¼šç”Ÿæˆä¸¤ä¸ªå˜é‡ï¼š<code>_BINARY_DIR</code>å’Œ<code>_SOURCE_DIR</code>ï¼Œä½†æ˜¯<code>cmake</code>ä¸­å…¶å®å·²ç»æœ‰ä¸¤ä¸ªé¢„å®šä¹‰çš„å˜é‡ï¼š<code>PROJECT_BINARY_DIR</code> å’Œ <code>PROJECT_SOURCR_DIR</code></p></li><li><p>å…³äºä¸¤ä¸ªå˜é‡æ˜¯å¦ç›¸åŒï¼Œæ¶‰åŠåˆ°æ˜¯å†…éƒ¨æ„å»ºè¿˜æ˜¯å¤–éƒ¨æ„å»º</p><ul><li><p>å†…éƒ¨æ„å»º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmake ./</span><br><span class="line">make</span><br></pre></td></tr></table></figure></li><li><p>å¤–éƒ¨æ„å»º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir build</span><br><span class="line">cd ./build</span><br><span class="line">cmake ../</span><br><span class="line">make</span><br></pre></td></tr></table></figure></li><li><p>å†…éƒ¨æ„å»ºå’Œå¤–éƒ¨æ„å»ºçš„ä¸åŒåœ¨äºï¼š<code>cmake </code>çš„å·¥ä½œç›®å½•ä¸åŒã€‚å†…éƒ¨æ„å»ºä¼šå°†<code>cmake</code>ç”Ÿæˆçš„ä¸­é—´æ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶æ”¾åœ¨å’Œé¡¹ç›®åŒä¸€ç›®å½•ï¼›å¤–éƒ¨æ„å»ºçš„è¯ï¼Œä¸­é—´æ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶ä¼šæ”¾åœ¨<code>build</code>ç›®å½•</p></li><li><p><code>PROJECT_SOURCE_DIR</code>å’Œ<code>_SOURCE_DIR</code>æ— è®ºå†…éƒ¨æ„å»ºè¿˜æ˜¯å¤–éƒ¨æ„å»ºï¼ŒæŒ‡å‘çš„å†…å®¹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æŒ‡å‘å·¥ç¨‹çš„æ ¹ç›®å½•</p></li><li><p><code>PROJECT_BINARY_DIR</code>å’Œ<code>_BINARY_DIR</code>æŒ‡å‘çš„ç›¸åŒå†…å®¹ï¼Œå†…éƒ¨æ„å»ºçš„æ—¶å€™æŒ‡å‘<code>CMakeLists.txt</code>æ–‡ä»¶çš„ç›®å½•ï¼Œå¤–éƒ¨æ„å»ºæŒ‡å‘<code>target</code>ç¼–è¯‘çš„ç›®å½•</p></li></ul></li></ul></li><li><p>ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</p><ul><li><p>è¯­æ³•ï¼š<code>add_executable(exename srcname)</code></p><blockquote><ul><li>exename:ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶çš„åå­—</li><li>srcname:åŸæ¥çš„æºæ–‡ä»¶</li></ul></blockquote></li><li><p>è¯¥å‘½ä»¤æŒ‡å®šç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶çš„åå­—ä»¥åŠæŒ‡å‡ºéœ€è¦ä¾èµ–çš„æºæ–‡ä»¶çš„æ–‡ä»¶å</p></li><li><p>è·å–æ–‡ä»¶è·¯å¾„ä¸­çš„æ‰€æœ‰æºæ–‡ä»¶</p><ul><li>å‘½ä»¤ï¼š<code>aux_sourcr_directory(&lt;dir&gt; &lt;variable&gt;)</code></li><li>ä¾‹å­ï¼š<code>aux_sourcr_directory(. DIR_SRCS)</code>ï¼Œå°†å½“å‰ç›®å½•ä¸‹çš„æºæ–‡ä»¶åå­—å­˜æ”¾åˆ°å˜é‡<code>DIR_SRCS</code>é‡Œé¢ ï¼Œå¦‚æœæºæ–‡ä»¶æ¯”è¾ƒå¤šï¼Œç›´æ¥ç”¨<code>DIR_SRCS</code>å˜é‡å³å¯</li></ul></li><li><p>ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼š<code>add_executable(Demo $&#123;DIR_SRCS&#125;)</code>ï¼Œå°†ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶å‘½åä¸ºï¼š<code>Demo</code></p></li></ul></li><li><p>ç”Ÿæˆ<code>lib</code>åº“</p><ul><li><p>å‘½ä»¤ï¼š<code>add_library(libname [SHARED|STATIC|MODULE] [EXCLUDE_FROM_ALL] source1 source2 ... sourceN)</code></p><blockquote><ul><li><code>libname</code>:ç”Ÿæˆçš„åº“æ–‡ä»¶çš„åå­—</li><li><code>[SHARED|STATIC|MODULE]</code>ï¼šç”Ÿæˆåº“æ–‡ä»¶çš„ç±»å‹ï¼ˆåŠ¨æ€åº“|é™æ€åº“|æ¨¡å—ï¼‰</li><li><code>[EXCLUDE_FROM_ALL]</code>ï¼šæœ‰è¿™ä¸ªå‚æ•°è¡¨ç¤ºè¯¥åº“ä¸ä¼šè¢«é»˜è®¤æ„å»º</li><li><code>source2 ... sourceN</code>ï¼šç”Ÿæˆåº“ä¾èµ–çš„æºæ–‡ä»¶ï¼Œå¦‚æœæºæ–‡ä»¶æ¯”è¾ƒå¤šï¼Œå¯ä»¥ä½¿ç”¨</li><li><code>aux_sourcr_directory</code>å‘½ä»¤è·å–è·¯å¾„ä¸‹æ‰€æœ‰æºæ–‡ä»¶ï¼Œå…·ä½“ç« èŠ‚å‚è§ï¼š<code>CMake</code>åˆæ¢-&gt;ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶-&gt;è·å–è·¯å¾„ä¸­æ‰€æœ‰æºæ–‡ä»¶</li></ul></blockquote></li><li><p>ä¾‹å­ï¼š<code>add_library(ALib SHARE alib.cpp)</code></p></li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">add_executable(demo demo.cpp) # ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</span><br><span class="line">add_library(common STATIC util.cpp) # ç”Ÿæˆé™æ€åº“</span><br><span class="line">add_library(common SHARED util.cpp) # ç”ŸæˆåŠ¨æ€åº“æˆ–å…±äº«åº“</span><br></pre></td></tr></table></figure><blockquote><p><code>add_library</code> é»˜è®¤ç”Ÿæˆæ˜¯é™æ€åº“ï¼Œé€šè¿‡ä»¥ä¸Šå‘½ä»¤ç”Ÿæˆæ–‡ä»¶åå­—ï¼Œ</p><ul><li>åœ¨ Linux ä¸‹æ˜¯ï¼š<br>demo<br>libcommon.a<br>libcommon.so</li><li>åœ¨ Windows ä¸‹æ˜¯ï¼š<br>demo.exe<br>common.lib<br>common.dll</li></ul></blockquote><ul><li><p>æ·»åŠ å¤´æ–‡ä»¶ç›®å½•</p><ul><li><p>å‘½ä»¤1ï¼š<code>target_include_directories(&lt;target&gt; [SYSTEM] [BEFORE]   &lt;INTERFACE|PUBLIC|PRIVATE&gt; [items1...]   [&lt;INTERFACE|PUBLIC|PRIVATE&gt; [items2...] ...])</code></p><blockquote><p>å½“æˆ‘ä»¬æ·»åŠ å­é¡¹ç›®ä¹‹åè¿˜éœ€è¦è®¾ç½®ä¸€ä¸ª<code>include</code>è·¯å¾„ï¼Œä¾‹å­ï¼š<br>eg:<code>target_include_directories(RigelEditor PUBLIC ./include/rgeditor)</code>ï¼Œè¡¨ç¤ºç»™<code>RigelEditor</code> è¿™ä¸ªå­é¡¹ç›®æ·»åŠ ä¸€ä¸ªåº“æ–‡ä»¶çš„è·¯å¾„</p></blockquote></li><li><p>å‘½ä»¤2ï¼š<code>include_directories([AFTER|BEFORE] [SYSTEM] dir1 [dir2 â€¦])</code></p><blockquote><p>å‚æ•°è§£æï¼š</p><ul><li>[AFTER|BEFORE]ï¼šæŒ‡å®šäº†è¦æ·»åŠ è·¯å¾„æ˜¯æ·»åŠ åˆ°åŸæœ‰åˆ—è¡¨ä¹‹å‰è¿˜æ˜¯ä¹‹å</li><li>[SYSTEM]ï¼šè‹¥æŒ‡å®šäº†<code>system</code>å‚æ•°ï¼Œåˆ™æŠŠè¢«åŒ…å«çš„è·¯å¾„å½“åšç³»ç»ŸåŒ…å«è·¯å¾„æ¥å¤„ç†</li><li>dir1 [dir2 â€¦]æŠŠè¿™äº›è·¯å¾„æ·»åŠ åˆ°<code>CMakeLists</code>åŠå…¶å­ç›®å½•çš„<code>CMakeLists</code>çš„å¤´æ–‡ä»¶åŒ…å«é¡¹ç›®ä¸­<br>ç›¸å½“äº<code>g++</code>é€‰é¡¹ä¸­çš„-lçš„å‚æ•°çš„ä½œç”¨</li><li>ä¸¾ä¾‹ï¼š<code>include_directories(&quot;/opt/MATLAB/R2012a/extern/include&quot;)</code></li></ul></blockquote></li></ul><ul><li>ä¸¤æ¡æŒ‡ä»¤çš„ä½œç”¨éƒ½æ˜¯è®²å°†<code>include</code>çš„ç›®å½•æ·»åŠ åˆ°ç›®æ ‡åŒºåˆ«åœ¨äº<code>include_directorie</code>sæ˜¯<code>CMake</code>ç¼–è¯‘æ‰€æœ‰ç›®æ ‡çš„ç›®å½•è¿›è¡Œæ·»åŠ ï¼Œ<code>target_include_directories</code>æ˜¯å°†<code>CMake</code>ç¼–è¯‘çš„æŒ‡å®šçš„ç‰¹å®šç›®æ ‡çš„åŒ…å«ç›®å½•è¿›è¡Œæ·»åŠ </li></ul></li><li><p>æ·»åŠ éœ€è¦é“¾æ¥çš„åº“æ–‡ä»¶è·¯å¾„</p><ul><li><p>å‘½ä»¤1:<code>target_link_libraries(&lt;target&gt; [item1 [item2 [...]]] [[debug|optimized|general] &lt;item&gt;] ...)</code></p><blockquote><ul><li>ä½œç”¨ï¼šä¸ºç»™å®šçš„ç›®æ ‡è®¾ç½®é“¾æ¥æ—¶ä½¿ç”¨çš„åº“ï¼ˆè®¾ç½®è¦é“¾æ¥çš„åº“æ–‡ä»¶çš„åç§°ï¼‰</li><li>eg:target_link_libraries(MyProject a b.a <a href="http://c.so/">c.so</a>)    //å°†è‹¥å¹²åº“æ–‡ä»¶é“¾æ¥åˆ°helloä¸­ï¼Œtarget_link_librariesé‡Œçš„åº“æ–‡ä»¶çš„é¡ºåºç¬¦åˆgcc/g++é“¾æ¥é¡ºåºè§„åˆ™ï¼Œå³ï¼šè¢«ä¾èµ–çš„åº“æ”¾åœ¨ä¾èµ–ä»–çš„åº“çš„åé¢ï¼Œå¦‚æœé¡ºåºæœ‰é”™ï¼Œé“¾æ¥å°†ä¼šæŠ¥é”™</li><li>å…³é”®å­—ï¼šdebugå¯¹åº”äºè°ƒè¯•é…ç½®</li><li>å…³é”®å­—ï¼šoptimizedå¯¹åº”äºæ‰€æœ‰å…¶ä»–çš„é…ç½®ç±»å‹</li><li>å…³é”®å­—ï¼šgeneralå¯¹åº”äºæ‰€æœ‰çš„é…ç½®ï¼ˆè¯¥å±æ€§æ˜¯é»˜è®¤å€¼ï¼‰</li></ul></blockquote></li><li><p>å‘½ä»¤2ï¼š<code>link_libraries</code></p><blockquote><ul><li>ä½œç”¨ï¼šç»™å½“å‰å·¥ç¨‹é“¾æ¥éœ€è¦çš„åº“æ–‡ä»¶ï¼ˆå…¨è·¯å¾„ï¼‰</li><li>eg:<code>link_libraries((&quot;/opt/MATLAB/R2012a/bin/glnxa64/libeng.so&quot;)</code>//å¿…é¡»æ·»åŠ å¸¦åå­—çš„å…¨è·¯å¾„</li></ul></blockquote></li><li><p>åŒºåˆ«ï¼š<code>target_link_libraries</code>å¯ä»¥ç»™å·¥ç¨‹æˆ–è€…åº“æ–‡ä»¶è®¾ç½®å…¶éœ€è¦é“¾æ¥çš„åº“æ–‡ä»¶ï¼Œè€Œä¸”ä¸éœ€è¦å¡«å†™å…¨è·¯å¾„ï¼Œä½†æ˜¯<code>link_libraries</code>åªèƒ½ç»™å·¥ç¨‹æ·»åŠ ä¾èµ–çš„åº“ï¼Œè€Œä¸”å¿…é¡»æ·»åŠ å…¨è·¯å¾„</p></li><li><p>æ·»åŠ éœ€è¦é“¾æ¥çš„åº“æ–‡ä»¶ç›®å½•</p><blockquote><ul><li><p>å‘½ä»¤ï¼šlink_directoriesï¼ˆæ·»åŠ éœ€è¦é“¾æ¥çš„åº“æ–‡ä»¶ç›®å½•ï¼‰</p></li><li><p>è¯­æ³•ï¼šlink_directories(directory1 directory2 â€¦)</p></li><li><p>ä¾‹å­ï¼šlink_directories(â€œ/opt/MATLAB/R2012a/bin/glnxa64â€)</p></li></ul></blockquote></li><li><p>æŒ‡ä»¤çš„åŒºåˆ«ï¼šæŒ‡ä»¤çš„å‰ç¼€å¸¦<code>target</code>ï¼Œè¡¨ç¤ºé’ˆå¯¹æŸä¸€ä¸ªç›®æ ‡è¿›è¡Œè®¾ç½®ï¼Œå¿…é¡»æŒ‡æ˜è®¾ç½®çš„ç›®æ ‡ï¼›<code>include_directories</code>æ˜¯åœ¨ç¼–è¯‘æ—¶ç”¨ï¼ŒæŒ‡æ˜<code>.h</code>æ–‡ä»¶çš„è·¯å¾„ï¼›<code>link_directoeies</code>æ˜¯åœ¨é“¾æ¥æ—¶ç”¨çš„ï¼ŒæŒ‡æ˜é“¾æ¥åº“çš„è·¯å¾„ï¼›<code>target_link_libraries</code>æ˜¯æŒ‡æ˜é“¾æ¥åº“çš„åå­—ï¼Œä¹Ÿå°±æ˜¯å…·ä½“è°é“¾æ¥åˆ°å“ªä¸ªåº“ã€‚<code>link_libraries</code>ä¸å¸¸ç”¨ï¼Œå› ä¸ºå¿…é¡»æŒ‡æ˜å¸¦æ–‡ä»¶åå…¨è·¯å¾„</p></li></ul></li><li><p>æ§åˆ¶ç›®æ ‡å±æ€§</p><ul><li><p>ä»¥ä¸Šçš„å‡ æ¡å‘½ä»¤çš„åŒºåˆ†éƒ½æ˜¯ï¼šæ˜¯å¦å¸¦<code>target</code>å‰ç¼€ï¼Œåœ¨<code>CMake</code>é‡Œé¢ï¼Œä¸€ä¸ª<code>target</code>æœ‰è‡ªå·±çš„å±æ€§é›†ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰æ˜¾ç¤ºçš„è®¾ç½®è¿™äº›<code>target</code>çš„å±æ€§çš„è¯ï¼Œ<code>CMake</code>é»˜è®¤æ˜¯ç”±ç›¸å…³çš„å…¨å±€å±æ€§æ¥å¡«å……<code>target</code>çš„å±æ€§ï¼Œæˆ‘ä»¬å¦‚æœéœ€è¦å•ç‹¬çš„è®¾ç½®<code>target</code>çš„å±æ€§ï¼Œéœ€è¦ä½¿ç”¨å‘½ä»¤ï¼š<code>set_target_properties()</code></p></li><li><p>å‘½ä»¤æ ¼å¼:</p><blockquote><p>set_target_properties(target1 target2 â€¦<br>PROPERTIES<br>å±æ€§åç§°1  å€¼<br>å±æ€§åç§°2  å€¼<br>â€¦<br>)</p></blockquote></li><li><p>æ§åˆ¶ç¼–è¯‘é€‰é¡¹çš„å±æ€§æ˜¯ï¼š<code>COMPILE_FLAGS</code></p></li><li><p>æ§åˆ¶é“¾æ¥é€‰é¡¹çš„å±æ€§æ˜¯ï¼š<code>LINK_FLAGS</code></p></li><li><p>æ§åˆ¶è¾“å‡ºè·¯å¾„çš„å±æ€§ï¼š<code>EXECUTABLE_OUTPUT_PATH</code>ï¼ˆexeçš„è¾“å‡ºè·¯å¾„ï¼‰ã€<code>LIBRARY_OUTPUT_PATH</code>ï¼ˆåº“æ–‡ä»¶çš„è¾“å‡ºè·¯å¾„ï¼‰</p></li><li><p>ä¸¾ä¾‹ï¼š</p><blockquote><p>set_target_properties(exe<br>PROPERTIES<br>LINK_FLAGS          -static<br>LINK_FLAGS_RELEASE  -s<br>)</p></blockquote><p>è¿™æ¡æŒ‡ä»¤ä¼šä½¿å¾—<code>exe</code>è¿™ä¸ªç›®æ ‡åœ¨æ‰€æœ‰çš„æƒ…å†µä¸‹éƒ½é‡‡ç”¨<code>-static</code>é€‰é¡¹ï¼Œè€Œä¸”åœ¨<code>release build</code>çš„æ—¶å€™<code>-static -s</code>é€‰é¡¹ã€‚ä½†æ˜¯è¿™ä¸ªå±æ€§ä»…ä»…åœ¨<code>exe</code>è¿™ä¸ª<code>target</code>ä¸Šé¢æœ‰æ•ˆ</p></li></ul></li></ul><h3 id="Cmakeæ„å»ºç¤ºä¾‹"><a href="#Cmakeæ„å»ºç¤ºä¾‹" class="headerlink" title="Cmakeæ„å»ºç¤ºä¾‹"></a>Cmakeæ„å»ºç¤ºä¾‹</h3><p>ç»å…¸çš„<code>helloworld</code>å¿…é¡»å‡ºç°å•Šï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª<code>main.cpp</code>åŒ…å«æºçš„æ–‡ä»¶</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> parameter_size, <span class="keyword">char</span> **parameter)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">1</span> + <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">int</span> b = a + <span class="number">3</span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;hello word  &quot;</span> &lt;&lt; parameter_size &lt;&lt; <span class="string">&quot;   &quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª <code>CMakeLists.txt</code>åŒä¸€ä¸ªç›®å½•ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 3.5)</span><br><span class="line">#é¡¹ç›®åç§°</span><br><span class="line">project(test_cmaka)</span><br><span class="line">#ä»£ç è·¯å¾„</span><br><span class="line">aux_source_directory(. DIR_TOOT_SRCS)</span><br><span class="line">#dubug æ¨¡å¼</span><br><span class="line">set (CMAKE_CXX_FLAGS  &quot;$&#123;CMAKE_CXX_FLAGS&#125; -g&quot;)</span><br><span class="line">#å°†å¯æ‰§è¡Œæ–‡ä»¶æ”¾å…¥binç›®å½•</span><br><span class="line">set( EXECUTABLE_OUTPUT_PATH $&#123;PROJECT_SOURCE_DIR&#125;/bin)</span><br><span class="line">#ç”Ÿæˆå¯æ‰§è¡Œçš„æ–‡ä»¶</span><br><span class="line">add_executable(main $&#123;DIR_TOOT_SRCS&#125;)</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶ç›®å½• å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|-- test_cmake</span><br><span class="line">    |-- main.cpp</span><br><span class="line">    |-- CMakeLists.txt</span><br></pre></td></tr></table></figure><p>ç°åœ¨å‡†å¤‡æ„å»ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼Œå¯¼èˆªåˆ°æ–‡ä»¶ç›®å½•ä¸‹ï¼Œåˆ›å»º<code>build</code>æ–‡ä»¶å¤¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir build</span><br></pre></td></tr></table></figure><p>è¿›å…¥<code>build</code>ç›®å½•ï¼Œæ‰§è¡Œå¤–éƒ¨æ„å»º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd build</span><br><span class="line"># cmake ../</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-- The C compiler identification is GNU 7.5.0</span><br><span class="line">-- The CXX compiler identification is GNU 7.5.0</span><br><span class="line">-- Check for working C compiler: /usr/bin/cc</span><br><span class="line">-- Check for working C compiler: /usr/bin/cc -- works</span><br><span class="line">-- Detecting C compiler ABI info</span><br><span class="line">-- Detecting C compiler ABI info - done</span><br><span class="line">-- Detecting C compile features</span><br><span class="line">-- Detecting C compile features - done</span><br><span class="line">-- Check for working CXX compiler: /usr/bin/c++</span><br><span class="line">-- Check for working CXX compiler: /usr/bin/c++ -- works</span><br><span class="line">-- Detecting CXX compiler ABI info</span><br><span class="line">-- Detecting CXX compiler ABI info - done</span><br><span class="line">-- Detecting CXX compile features</span><br><span class="line">-- Detecting CXX compile features - done</span><br><span class="line">-- Configuring done</span><br><span class="line">-- Generating done</span><br><span class="line">-- Build files have been written to: /root/share/C++/test_cmake/build</span><br></pre></td></tr></table></figure><p>å†çœ‹çœ‹ç›®å½•ä¸‹çš„æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CMakeCache.txt  CMakeFiles  cmake_install.cmake  Makefile</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æˆåŠŸç”Ÿæˆäº†Makefileï¼Œè¿˜æœ‰ä¸€äº›cmakeè¿è¡Œæ—¶è‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶<br>ç„¶ååœ¨ç»ˆç«¯ä¸‹è¾“å…¥makeå¹¶å›è½¦,è¾“å‡ºä»¥ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Scanning dependencies of target main</span><br><span class="line">[ 50%] Building CXX object CMakeFiles/main.dir/main.cpp.o</span><br><span class="line">[100%] Linking CXX executable ../bin/main</span><br><span class="line">[100%] Built target main</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œæ–‡ä»¶ç›®å½•å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">|-- test_cmake</span><br><span class="line">    |-- bin</span><br><span class="line">    |-- build</span><br><span class="line">    |-- main.cpp</span><br><span class="line">    |-- CMakeLists.txt</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶åœ¨<code>bin</code>ç›®å½•ä¸‹ï¼Œå¯¼èˆªåˆ°è¯¥ç›®å½•ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ../bin</span><br><span class="line">./main</span><br></pre></td></tr></table></figure><p>äº§ç”Ÿé¢„æœŸçš„è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hello word  1 </span><br></pre></td></tr></table></figure><p><code>github</code>ä¸Šæœ‰ä¸é”™çš„<code>CMakeâ€”â€”examples</code>  é“¾æ¥ï¼š<a href="https://github.com/ttroy50/cmake-examples">https://github.com/ttroy50/cmake-examples</a></p><h1 id="Mesonç¬”è®°"><a href="#Mesonç¬”è®°" class="headerlink" title="Mesonç¬”è®°"></a>Mesonç¬”è®°</h1><h2 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="Linuxå®‰è£…-1"><a href="#Linuxå®‰è£…-1" class="headerlink" title="Linuxå®‰è£…"></a>Linuxå®‰è£…</h3><ul><li><p>MesonåŸºäºPython3è¿è¡Œï¼Œè¦æ±‚Pythonç‰ˆæœ¬3.5ä»¥ä¸Š</p></li><li><p>å®‰è£…ä¾èµ– <code>ninja-build</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ninja-build</span><br></pre></td></tr></table></figure></li><li><p>å®‰è£…<code>Meson</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip3 install meson #root      </span><br><span class="line"></span><br><span class="line">pip3 install --user meson #user å®˜æ–¹æ¨è</span><br></pre></td></tr></table></figure></li><li><p>ä¹Ÿä»<code>git</code>ä¸‹è½½å®‰è£…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/mesonbuild/meson.git /path/to/sourcedir</span><br></pre></td></tr></table></figure></li></ul><h3 id="Mesonæ„å»ºç¤ºä¾‹"><a href="#Mesonæ„å»ºç¤ºä¾‹" class="headerlink" title="Mesonæ„å»ºç¤ºä¾‹"></a>Mesonæ„å»ºç¤ºä¾‹</h3><p>ä¾ç„¶ç»å…¸çš„<code>helloworld</code>ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª<code>main.c</code>åŒ…å«æºçš„æ–‡ä»¶</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># main.c</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Hello there.\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª <code>meson.build</code>åŒä¸€ä¸ªç›®å½•ä¸­è°ƒç”¨çš„æ–‡ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">project(&#x27;tutorial&#x27;, &#x27;c&#x27;)</span><br><span class="line">executable(&#x27;main&#x27;, &#x27;main.c&#x27;)</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶ç›®å½•å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|-- test_meson</span><br><span class="line">    |-- main.c</span><br><span class="line">    |-- meson.build</span><br></pre></td></tr></table></figure><p>ç°åœ¨å‡†å¤‡æ„å»ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼Œå¯¼èˆªåˆ°æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#æ„å»ºç¨‹åº</span><br><span class="line">$ meson build</span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„æ„å»ºç›®å½•<code>build</code>æ¥ä¿å­˜æ‰€æœ‰ç¼–è¯‘å™¨è¾“å‡ºã€‚<code>Meson</code> ä¸å…¶ä»–ä¸€äº›æ„å»ºç³»ç»Ÿçš„ä¸åŒä¹‹å¤„åœ¨äºå®ƒä¸å…è®¸æºä»£ç æ„å»ºã€‚æ‚¨å¿…é¡»å§‹ç»ˆåˆ›å»ºä¸€ä¸ªå•ç‹¬çš„æ„å»ºç›®å½•ã€‚å¸¸è§çš„çº¦å®šæ˜¯å°†é»˜è®¤æ„å»ºç›®å½•æ”¾åœ¨é¡¶çº§æºç›®å½•çš„å­ç›®å½•ä¸­</p><p>å½“ <code>Meson</code> è¿è¡Œæ—¶ï¼Œå®ƒä¼šæ‰“å°ä»¥ä¸‹è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">The Meson build system</span><br><span class="line">Version: 0.58.1</span><br><span class="line">Source dir: /root/share/C++/test_meson</span><br><span class="line">Build dir: /root/share/C++/test_meson/build</span><br><span class="line">Build type: native build</span><br><span class="line">Project name: tutorial</span><br><span class="line">Project version: undefined</span><br><span class="line">C compiler for the host machine: cc (gcc 7.5.0 &quot;cc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0&quot;)</span><br><span class="line">C linker for the host machine: cc ld.bfd 2.30</span><br><span class="line">Host machine cpu family: x86_64</span><br><span class="line">Host machine cpu: x86_64</span><br><span class="line">Build targets in project: 1</span><br></pre></td></tr></table></figure><p>ç°åœ¨å·²ç»å‡†å¤‡å¥½æ„å»ºæˆ‘ä»¬çš„ä»£ç äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd buildd</span><br><span class="line">$ ninja</span><br></pre></td></tr></table></figure><p>å¦‚æœæ‚¨çš„ <code>Meson</code> ç‰ˆæœ¬é«˜äº <code>0.55.0</code>ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ–°çš„åç«¯ä¸å¯çŸ¥æ„å»ºå‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd build</span><br><span class="line">$ meson compile</span><br></pre></td></tr></table></figure><p>ä¸€æ—¦æ„å»ºäº†å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿è¡Œå®ƒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./main</span><br></pre></td></tr></table></figure><p>è¿™ä¼šäº§ç”Ÿé¢„æœŸçš„è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello there.</span><br></pre></td></tr></table></figure><p>â€‹    </p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://mubu.com/doc/t1VDCEn4O0#o-17f166a665726b18d">https://mubu.com/doc/t1VDCEn4O0#o-17f166a665726b18d</a></p><p><a href="https://cmake.org/documentation">https://cmake.org/documentation</a></p><p><a href="https://cmake.org/cmake/help/latest/guide/tutorial/index.html">https://cmake.org/cmake/help/latest/guide/tutorial/index.html</a></p><p><a href="https://mesonbuild.com/">https://mesonbuild.com/</a></p>]]></content>
    
    
    <summary type="html">å­¦ä¹ ç”Ÿäº§åŠ›å·¥å…·CMakeã€Meson</summary>
    
    
    
    <category term="Tools" scheme="http://example.com/categories/Tools/"/>
    
    
    <category term="CMake" scheme="http://example.com/tags/CMake/"/>
    
    <category term="Meson" scheme="http://example.com/tags/Meson/"/>
    
  </entry>
  
  <entry>
    <title>Algorithm</title>
    <link href="http://example.com/2021/02/21/Algorithm/"/>
    <id>http://example.com/2021/02/21/Algorithm/</id>
    <published>2021-02-21T13:32:33.000Z</published>
    <updated>2021-07-21T14:29:21.773Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ»‘åŠ¨çª—å£"><a href="#æ»‘åŠ¨çª—å£" class="headerlink" title="æ»‘åŠ¨çª—å£"></a>æ»‘åŠ¨çª—å£</h1><h2 id="3-æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²"><a href="#3-æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²" class="headerlink" title="3. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²"></a><a href="https://leetcode-cn.com/problems/longest-substring-without-repeating-characters/">3. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²</a></h2><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² <code>s</code> ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ <strong>æœ€é•¿å­ä¸²</strong> çš„é•¿åº¦ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: s = &quot;abcabcbb&quot;</span><br><span class="line">è¾“å‡º: 3 </span><br><span class="line">è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;abc&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: s = &quot;bbbbb&quot;</span><br><span class="line">è¾“å‡º: 1</span><br><span class="line">è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;b&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 1ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: s = &quot;pwwkew&quot;</span><br><span class="line">è¾“å‡º: 3</span><br><span class="line">è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;wke&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚</span><br><span class="line">     è¯·æ³¨æ„ï¼Œä½ çš„ç­”æ¡ˆå¿…é¡»æ˜¯ å­ä¸² çš„é•¿åº¦ï¼Œ&quot;pwke&quot; æ˜¯ä¸€ä¸ªå­åºåˆ—ï¼Œä¸æ˜¯å­ä¸²ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 4:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: s = &quot;&quot;</span><br><span class="line">è¾“å‡º: 0</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>0 &lt;= s.length &lt;= 5 * 104</code></li><li><code>s</code> ç”±è‹±æ–‡å­—æ¯ã€æ•°å­—ã€ç¬¦å·å’Œç©ºæ ¼ç»„æˆ</li></ul><p>è¿™é‡Œå¯ä»¥å»ºç«‹ä¸€ä¸ª <code>HashMap</code>ï¼Œå»ºç«‹æ¯ä¸ªå­—ç¬¦å’Œå…¶æœ€åå‡ºç°ä½ç½®ä¹‹é—´çš„æ˜ å°„ï¼Œç„¶åéœ€è¦å®šä¹‰ä¸¤ä¸ªå˜é‡ <code>res</code> å’Œ <code>left</code>ï¼Œå…¶ä¸­<code>res</code>ç”¨æ¥è®°å½•æœ€é•¿æ— é‡å¤å­ä¸²çš„é•¿åº¦ï¼Œ<code>left </code>æŒ‡å‘è¯¥æ— é‡å¤å­ä¸²å·¦è¾¹çš„èµ·å§‹ä½ç½®çš„å‰ä¸€ä¸ªï¼Œç”±äºæ˜¯å‰ä¸€ä¸ªï¼Œæ‰€ä»¥åˆå§‹åŒ–å°±æ˜¯ -1ï¼Œç„¶åéå†æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œå¯¹äºæ¯ä¸€ä¸ªéå†åˆ°çš„å­—ç¬¦ï¼Œå¦‚æœè¯¥å­—ç¬¦å·²ç»åœ¨ <code>HashMap</code> ä¸­å­˜åœ¨äº†ï¼Œå¹¶ä¸”å¦‚æœå…¶æ˜ å°„å€¼å¤§äº<code> left</code> çš„è¯ï¼Œé‚£ä¹ˆæ›´æ–°<code> left</code> ä¸ºå½“å‰æ˜ å°„å€¼ã€‚ç„¶åæ˜ å°„å€¼æ›´æ–°ä¸ºå½“å‰åæ ‡<code>i</code>ï¼Œè¿™æ ·ä¿è¯äº† <code>left </code>å§‹ç»ˆä¸ºå½“å‰è¾¹ç•Œçš„å‰ä¸€ä¸ªä½ç½®ï¼Œç„¶åè®¡ç®—çª—å£é•¿åº¦çš„æ—¶å€™ï¼Œç›´æ¥ç”¨<code>i-left</code>å³å¯ï¼Œç”¨æ¥æ›´æ–°ç»“æœ<code>res</code>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>, left = <span class="number">-1</span>, n = s.<span class="built_in">size</span>();</span><br><span class="line">        unordered_map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; m;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (m.<span class="built_in">count</span>(s[i]) &amp;&amp; m[s[i]] &gt; left) &#123;</span><br><span class="line">                left = m[s[i]];  </span><br><span class="line">            &#125;</span><br><span class="line">            m[s[i]] = i;</span><br><span class="line">            res = <span class="built_in">max</span>(res, i - left);            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢è¿™ç§è§£æ³•ä½¿ç”¨äº† <code>HashSet</code>ï¼Œæ ¸å¿ƒç®—æ³•å’Œä¸Šé¢çš„å¾ˆç±»ä¼¼ï¼ŒæŠŠå‡ºç°è¿‡çš„å­—ç¬¦éƒ½æ”¾å…¥<code>HashSet</code>ä¸­ï¼Œé‡åˆ° <code>HashSet </code>ä¸­æ²¡æœ‰çš„å­—ç¬¦å°±åŠ å…¥<code> HashSet</code> ä¸­å¹¶æ›´æ–°ç»“æœ <code>res</code>ï¼Œå¦‚æœé‡åˆ°é‡å¤çš„ï¼Œåˆ™ä»å·¦è¾¹å¼€å§‹åˆ å­—ç¬¦ï¼Œç›´åˆ°åˆ åˆ°é‡å¤çš„å­—ç¬¦åœæ­¢ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> n=s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> left=<span class="number">0</span>, res=<span class="number">0</span>;</span><br><span class="line">        unordered_set&lt;<span class="keyword">char</span>&gt; st;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">            <span class="keyword">while</span>(st.<span class="built_in">find</span>(s[i])!=st.<span class="built_in">end</span>())&#123;</span><br><span class="line">                st.<span class="built_in">erase</span>(s[left]);</span><br><span class="line">                left++;</span><br><span class="line">            &#125;</span><br><span class="line">            st.<span class="built_in">insert</span>(s[i]);</span><br><span class="line">            res=<span class="built_in">max</span>(res,i-left+<span class="number">1</span>);</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="76-æœ€å°è¦†ç›–å­ä¸²"><a href="#76-æœ€å°è¦†ç›–å­ä¸²" class="headerlink" title="76. æœ€å°è¦†ç›–å­ä¸²"></a><a href="https://leetcode-cn.com/problems/minimum-window-substring/">76. æœ€å°è¦†ç›–å­ä¸²</a></h2><p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² <code>s</code> ã€ä¸€ä¸ªå­—ç¬¦ä¸² <code>t</code> ã€‚è¿”å› <code>s</code> ä¸­æ¶µç›– <code>t</code> æ‰€æœ‰å­—ç¬¦çš„æœ€å°å­ä¸²ã€‚å¦‚æœ <code>s</code> ä¸­ä¸å­˜åœ¨æ¶µç›– <code>t</code> æ‰€æœ‰å­—ç¬¦çš„å­ä¸²ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸² <code>&quot;&quot;</code> ã€‚</p><p><strong>æ³¨æ„ï¼š</strong></p><ul><li>å¯¹äº <code>t</code> ä¸­é‡å¤å­—ç¬¦ï¼Œæˆ‘ä»¬å¯»æ‰¾çš„å­å­—ç¬¦ä¸²ä¸­è¯¥å­—ç¬¦æ•°é‡å¿…é¡»ä¸å°‘äº <code>t</code> ä¸­è¯¥å­—ç¬¦æ•°é‡ã€‚</li><li>å¦‚æœ <code>s</code> ä¸­å­˜åœ¨è¿™æ ·çš„å­ä¸²ï¼Œæˆ‘ä»¬ä¿è¯å®ƒæ˜¯å”¯ä¸€çš„ç­”æ¡ˆã€‚</li></ul><p> <strong>è¿›é˜¶ï¼š</strong>ä½ èƒ½è®¾è®¡ä¸€ä¸ªåœ¨ <code>o(n)</code> æ—¶é—´å†…è§£å†³æ­¤é—®é¢˜çš„ç®—æ³•å—ï¼Ÿ</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs = &quot;ADOBECODEBANC&quot;, t = &quot;ABC&quot;</span><br><span class="line">è¾“å‡ºï¼š&quot;BANC&quot;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs = &quot;a&quot;, t = &quot;a&quot;</span><br><span class="line">è¾“å‡ºï¼š&quot;a&quot;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: s = &quot;a&quot;, t = &quot;aa&quot;</span><br><span class="line">è¾“å‡º: &quot;&quot;</span><br><span class="line">è§£é‡Š: t ä¸­ä¸¤ä¸ªå­—ç¬¦ &#x27;a&#x27; å‡åº”åŒ…å«åœ¨ s çš„å­ä¸²ä¸­ï¼Œ</span><br><span class="line">å› æ­¤æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„å­å­—ç¬¦ä¸²ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= s.length, t.length &lt;= 105</code></li><li><code>s</code> å’Œ <code>t</code> ç”±è‹±æ–‡å­—æ¯ç»„æˆ</li></ul><p>è¿™é“é¢˜ç»™äº†æˆ‘ä»¬ä¸€ä¸ªåŸå­—ç¬¦ä¸²<code>s</code>ï¼Œè¿˜æœ‰ä¸€ä¸ªç›®æ ‡å­—ç¬¦ä¸²<code>t</code>ï¼Œè®©åœ¨<code>s</code>ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ€çŸ­çš„å­ä¸²ï¼Œä½¿å¾—å…¶åŒ…å«äº†<code>t</code>ä¸­çš„æ‰€æœ‰çš„å­—æ¯ï¼Œå¹¶ä¸”é™åˆ¶äº†æ—¶é—´å¤æ‚åº¦ä¸º<code> O(n)</code>ã€‚è¿™é“é¢˜çš„è¦æ±‚æ˜¯è¦åœ¨<code>O(n) </code>çš„æ—¶é—´åº¦é‡Œå®ç°æ‰¾åˆ°è¿™ä¸ªæœ€å°çª—å£å­—ä¸²ï¼Œæš´åŠ›æœç´¢ <code>Brute Force </code>è‚¯å®šæ˜¯ä¸èƒ½ç”¨çš„ï¼Œå› ä¸ºéå†æ‰€æœ‰çš„å­ä¸²çš„æ—¶é—´å¤æ‚åº¦æ˜¯å¹³æ–¹çº§çš„ã€‚é‚£ä¹ˆæ¥æƒ³ä¸€ä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦å¡çš„è¿™ä¹ˆä¸¥ï¼Œè¯´æ˜å¿…é¡»åœ¨ä¸€æ¬¡éå†ä¸­å®Œæˆä»»åŠ¡ï¼Œå½“ç„¶éå†è‹¥å¹²æ¬¡ä¹Ÿæ˜¯<code> O(n)</code>ï¼Œä½†ä¸ä¸€å®šæœ‰è¿™ä¸ªå¿…è¦ï¼Œå°è¯•å°±ä¸€æ¬¡éå†æ‹¿ä¸‹ï¼é‚£ä¹ˆå†æ¥æƒ³ï¼Œæ—¢ç„¶è¦åŒ…å«Tä¸­æ‰€æœ‰çš„å­—æ¯ï¼Œé‚£ä¹ˆå¯¹äºTä¸­çš„æ¯ä¸ªå­—æ¯ï¼Œè‚¯å®šè¦å¿«é€ŸæŸ¥æ‰¾æ˜¯å¦åœ¨å­ä¸²ä¸­ï¼Œæ—¢ç„¶æ€»æ—¶é—´éƒ½å¡åœ¨äº†<code> O(n)</code>ï¼Œè‚¯å®šä¸æƒ³åœ¨è¿™é‡Œè¿˜æµªè´¹æ—¶é—´ï¼Œå°±ç”¨ç©ºé—´æ¢æ—¶é—´ï¼ˆä¹Ÿå°±ç®—æ³•é¢˜ä¸­å¯ä»¥è¿™ä¹ˆå¹²äº†ï¼Œä¸ƒè€å…«åçš„å¯Œç¿å°±ç®—ç”¨å¤§åˆ«é‡ä¹Ÿæ¢ä¸æ¥æ—¶é—´å•Šã€‚ä¾ä¾ä¸œæœ›ï¼Œæœ›çš„å°±æ˜¯æ—¶é—´å‘ï¼‰ï¼Œä½¿ç”¨<code> HashMap</code>ï¼Œå»ºç«‹Tä¸­æ¯ä¸ªå­—æ¯ä¸å…¶å‡ºç°æ¬¡æ•°ä¹‹é—´çš„æ˜ å°„ï¼Œé‚£ä¹ˆä½ å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œä¸ºå•¥ç”¨ <code>HashMap </code>ä¸ç”¨ <code>HashSet </code>å‘¢ï¼Ÿ</p><p>ä¸ºå•¥è¦ç”¨ <code>HashMap</code>ï¼Œè€Œä¸æ˜¯ <code>HashSet</code>ï¼Œå› ä¸ºè¦ç»Ÿè®¡<code>t</code>ä¸²ä¸­å­—æ¯çš„ä¸ªæ•°ï¼Œè€Œä¸æ˜¯ä»…ä»…çœ‹æŸä¸ªå­—æ¯æ˜¯å¦åœ¨<code>t</code>ä¸²ä¸­å‡ºç°ã€‚ç»Ÿè®¡å¥½<code>t</code>ä¸²ä¸­å­—æ¯çš„ä¸ªæ•°äº†ä¹‹åï¼Œå¼€å§‹éå†<code>s</code>ä¸²ï¼Œå¯¹äº<code>s</code>ä¸­çš„æ¯ä¸ªéå†åˆ°çš„å­—æ¯ï¼Œéƒ½åœ¨<code>HashMap</code>ä¸­çš„æ˜ å°„å€¼å‡1ï¼Œå¦‚æœå‡1åçš„æ˜ å°„å€¼ä»å¤§äºç­‰äº0ï¼Œè¯´æ˜å½“å‰éå†åˆ°çš„å­—æ¯æ˜¯Tä¸²ä¸­çš„å­—æ¯ï¼Œä½¿ç”¨ä¸€ä¸ªè®¡æ•°å™¨<code> cnt</code>ï¼Œä½¿å…¶è‡ªå¢1ã€‚å½“<code>cnt</code> å’ŒTä¸²å­—æ¯ä¸ªæ•°ç›¸ç­‰æ—¶ï¼Œè¯´æ˜æ­¤æ—¶çš„çª—å£å·²ç»åŒ…å«äº†Tä¸²ä¸­çš„æ‰€æœ‰å­—æ¯ï¼Œæ­¤æ—¶æ›´æ–°ä¸€ä¸ª<code> minLen</code> å’Œç»“æœ <code>res</code>ï¼Œè¿™é‡Œçš„ <code>minLen</code> æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨æ¥è®°å½•å‡ºç°è¿‡çš„åŒ…å«Tä¸²æ‰€æœ‰å­—æ¯çš„æœ€çŸ­çš„å­ä¸²çš„é•¿åº¦ï¼Œç»“æœ res å°±æ˜¯è¿™ä¸ªæœ€çŸ­çš„å­ä¸²ã€‚ç„¶åå¼€å§‹æ”¶ç¼©å·¦è¾¹ç•Œï¼Œç”±äºéå†çš„æ—¶å€™ï¼Œå¯¹æ˜ å°„å€¼å‡äº†1ï¼Œæ‰€ä»¥æ­¤æ—¶å»é™¤å­—æ¯çš„æ—¶å€™ï¼Œå°±è¦æŠŠå‡å»çš„1åŠ å›æ¥ï¼Œæ­¤æ—¶å¦‚æœåŠ 1åçš„å€¼å¤§äº0äº†ï¼Œè¯´æ˜æ­¤æ—¶å°‘äº†ä¸€ä¸ªTä¸­çš„å­—æ¯ï¼Œé‚£ä¹ˆ<code>cnt</code>å€¼å°±è¦å‡1äº†ï¼Œç„¶åç§»åŠ¨å·¦è¾¹ç•Œ<code>left</code>ã€‚ä½ å¯èƒ½ä¼šç–‘é—®ï¼Œå¯¹äºä¸åœ¨Tä¸²ä¸­çš„å­—æ¯çš„æ˜ å°„å€¼ä¹Ÿè¿™ä¹ˆåŠ å‘€å‡å‘€çš„ï¼ŒçœŸçš„å¤§ä¸ˆå¤«ï¼ˆå¸¦èƒ¶å¸ƒï¼‰å—ï¼Ÿå…¶å®æ²¡å•¥äº‹ï¼Œå› ä¸ºå¯¹äºä¸åœ¨Tä¸²ä¸­çš„å­—æ¯ï¼Œå‡1åï¼Œå˜-1ï¼Œ<code>cnt </code>ä¸ä¼šå¢åŠ ï¼Œä¹‹åæ”¶ç¼©å·¦è¾¹ç•Œçš„æ—¶å€™ï¼Œæ˜ å°„å€¼åŠ 1åä¸º0ï¼Œ<code>cnt </code>ä¹Ÿä¸ä¼šå‡å°‘ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰ä»€ä¹ˆå½±å“å•¦ã€‚ä¸‹é¢æ˜¯å…·ä½“çš„ä»£ç å®ç°ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">minWindow</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        string res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        unordered_map&lt;<span class="keyword">char</span>, <span class="keyword">int</span>&gt; letterCnt;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, cnt = <span class="number">0</span>, minLen = INT_MAX;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> c : t) ++letterCnt[c];         <span class="comment">//éå†t</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (--letterCnt[s[i]] &gt;= <span class="number">0</span>) ++cnt;   <span class="comment">//--letterCnt[s[i]] &gt;= 0ï¼Œs[i]åœ¨tä¸­</span></span><br><span class="line">            <span class="keyword">while</span> (cnt == t.<span class="built_in">size</span>()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (minLen &gt; i - left + <span class="number">1</span>) &#123;</span><br><span class="line">                    minLen = i - left + <span class="number">1</span>;</span><br><span class="line">                    res = s.<span class="built_in">substr</span>(left, minLen); <span class="comment">//ä»leftå¼€å§‹ï¼Œé•¿åº¦ä¸ºminLençš„å­—ç¬¦ä¸²</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//æ”¶ç¼©å·¦è¾¹ç•Œ ++letterCnt[s[left]] &gt; 0ï¼Œ 0-&gt;1 è¯¥å…ƒç´ åœ¨tä¸­ï¼Œ</span></span><br><span class="line">                <span class="keyword">if</span> (++letterCnt[s[left]] &gt; <span class="number">0</span>) --cnt;   </span><br><span class="line">                <span class="comment">//å› ä¸ºä¸åœ¨tä¸­çš„æœ¬æ¥ä¸º0ï¼Œå…ˆå‡å»ï¼Œç°åœ¨å†å¢åŠ ï¼Œæœ€ç»ˆè¿˜æ˜¯0.</span></span><br><span class="line">                ++left;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">æ•´ç†è®°å½•åˆ·çš„ç®—æ³•é¢˜ï¼Œå¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´å•Šï¼é¢˜è§£å‚è€ƒäº†Grand Yang(https://github.com/grandyang)</summary>
    
    
    
    <category term="code" scheme="http://example.com/categories/code/"/>
    
    
    <category term="Algorithm" scheme="http://example.com/tags/Algorithm/"/>
    
    <category term="Leetcode" scheme="http://example.com/tags/Leetcode/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://example.com/2021/02/14/hello-world/"/>
    <id>http://example.com/2021/02/14/hello-world/</id>
    <published>2021-02-13T16:00:00.000Z</published>
    <updated>2021-07-11T06:57:09.659Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Install-hexo"><a href="#Install-hexo" class="headerlink" title="Install hexo"></a>Install hexo</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g hexo-cli</span><br></pre></td></tr></table></figure><h3 id="Create-myblog"><a href="#Create-myblog" class="headerlink" title="Create myblog"></a>Create myblog</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo init myblog</span><br></pre></td></tr></table></figure><p><strong>å‡ºç° hexo init å¤±è´¥é—®é¢˜ï¼Œ<a href="https://blog.csdn.net/qq_43580193/article/details/117341489?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_baidulandingword-0&spm=1001.2101.3001.4242">è§£å†³æ–¹æ³•</a>æ›¿æ¢Githubè¿æ¥</strong></p><h3 id="å°†Hexoéƒ¨ç½²åˆ°GitHub"><a href="#å°†Hexoéƒ¨ç½²åˆ°GitHub" class="headerlink" title="å°†Hexoéƒ¨ç½²åˆ°GitHub"></a>å°†Hexoéƒ¨ç½²åˆ°GitHub</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git #å†’å·åé¢æœ‰ç©ºæ ¼</span><br><span class="line">  repository: git@github.com:xuhuigeren/xuhuigeren.github.io.git  #ssh/httpsä»“åº“åœ°å€</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p><strong>å›åˆ° myblog æ–‡ä»¶å¤¹ä¸­ï¼Œæ‰“å¼€ Git Bashï¼Œå®‰è£…Gitéƒ¨ç½²æ’ä»¶ï¼Œè¾“å…¥å‘½ä»¤</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p><strong>ç„¶ååˆ†åˆ«è¾“å…¥ä»¥ä¸‹ä¸‰æ¡å‘½ä»¤ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean   <span class="comment">#æ¸…é™¤ç¼“å­˜æ–‡ä»¶ db.json å’Œå·²ç”Ÿæˆçš„é™æ€æ–‡ä»¶ public</span></span><br><span class="line">hexo g       <span class="comment">#ç”Ÿæˆç½‘ç«™é™æ€æ–‡ä»¶åˆ°é»˜è®¤è®¾ç½®çš„ public æ–‡ä»¶å¤¹(hexo generate çš„ç¼©å†™)</span></span><br><span class="line">hexo d       <span class="comment">#è‡ªåŠ¨ç”Ÿæˆç½‘ç«™é™æ€æ–‡ä»¶ï¼Œå¹¶éƒ¨ç½²åˆ°è®¾å®šçš„ä»“åº“(hexo deploy çš„ç¼©å†™)</span></span><br></pre></td></tr></table></figure><p><strong>å®Œæˆä»¥åï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ <a href="https://xuhuigeren.github.io/">https://xuhuigeren.github.io</a>  å°±å¯ä»¥æ‰“å¼€ä½ çš„ç½‘é¡µäº†</strong></p><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    <summary type="html">Welcome to Hexo</summary>
    
    
    
    <category term="æˆ‘çš„åšå®¢" scheme="http://example.com/categories/%E6%88%91%E7%9A%84%E5%8D%9A%E5%AE%A2/"/>
    
    
    <category term="Hexo" scheme="http://example.com/tags/Hexo/"/>
    
  </entry>
  
</feed>
